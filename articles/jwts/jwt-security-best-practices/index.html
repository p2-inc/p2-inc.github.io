<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-articles docs-version-current docs-doc-page docs-doc-id-jwts/jwt-security-best-practices" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Security Best Practices | Managed Keycloak Hosting and Enterprise Keycloak Support</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://phasetwo.io/articles/jwts/jwt-security-best-practices/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="keycloak, iam, sso"><meta data-rh="true" property="og:logo" content="/img/appstore.png" size="1024x1024"><meta data-rh="true" property="og:image" content="/img/og_image_app.png" size="1200x630"><meta data-rh="true" property="og:logo" content="/img/playstore.png" size="512x512"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-articles-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-articles-current"><meta data-rh="true" property="og:title" content="Security Best Practices | Managed Keycloak Hosting and Enterprise Keycloak Support"><meta data-rh="true" name="description" content="JSON Web Tokens (JWTs) are a widely adopted standard for authentication and authorization in modern web applications. Despite some criticism regarding their security, JWTs can provide robust protection when properly implemented."><meta data-rh="true" property="og:description" content="JSON Web Tokens (JWTs) are a widely adopted standard for authentication and authorization in modern web applications. Despite some criticism regarding their security, JWTs can provide robust protection when properly implemented."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://phasetwo.io/articles/jwts/jwt-security-best-practices/"><link data-rh="true" rel="alternate" href="https://phasetwo.io/articles/jwts/jwt-security-best-practices/" hreflang="en"><link data-rh="true" rel="alternate" href="https://phasetwo.io/articles/jwts/jwt-security-best-practices/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://W4PN7W5A70-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"JSON Web Tokens (JWT)","item":"https://phasetwo.io/articles/category/json-web-tokens-jwt"},{"@type":"ListItem","position":2,"name":"Security Best Practices","item":"https://phasetwo.io/articles/jwts/jwt-security-best-practices"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Managed Keycloak Hosting and Enterprise Keycloak Support RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Managed Keycloak Hosting and Enterprise Keycloak Support Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="Managed Keycloak Hosting and Enterprise Keycloak Support" href="/opensearch.xml">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss/dist/preflight.min.css">



<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script src="https://www.termsfeed.com/public/cookie-consent/4.1.0/cookie-consent.js" charset="UTF-8" defer="defer"></script>
<script src="https://www.googletagmanager.com/gtag/js?id=UA-160183620-1" async data-cookie-consent="tracking"></script><link rel="stylesheet" href="/assets/css/styles.d5ed0623.css">
<script src="/assets/js/runtime~main.120e29cb.js" defer="defer"></script>
<script src="/assets/js/main.07c49280.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#3fa1e3;color:#fff" role="banner"><div class="content_knG7 announcementBarContent_xLdY"><a href="/blog/dashboard-launch/">Announcing our new Dashboard!</a> New self-serve features for cluster/realm management (observability, configuration, and more).</div></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_phase_slash.svg" alt="Phase Two" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_phase_slash.svg" alt="Phase Two" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/hosting/">Hosting</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/support/">Support</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/support/">Enterprise Support</a></li><li><a class="dropdown__link" href="/support/migrate-to-keycloak/">Migration to Keycloak</a></li><li><a class="dropdown__link" href="/support/emergency-support/">Emergency Keycloak Assistance</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Product</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/product/onprem/">On-Premise Deployment</a></li><li><a class="dropdown__link" href="/product/sso/">SSO</a></li><li><a class="dropdown__link" href="/product/identity/">Identity</a></li><li><a class="dropdown__link" href="/product/organizations/">Organizations</a></li><li><a class="dropdown__link" href="/product/adminportal/">Admin Portal</a></li><li><a class="dropdown__link" href="/product/integrations/">Integrations</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Developers</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/introduction/">Docs</a></li><li><a class="dropdown__link" href="/api/phase-two-admin-rest-api/">API</a></li><li><a href="https://github.com/p2-inc#our-extensions-" target="_blank" rel="noopener noreferrer" class="dropdown__link">Keycloak Extensions<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/articles/introduction/">Articles</a></li><li><a href="https://github.com/p2-inc/" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><a class="navbar__item navbar__link" href="/pricing/">Pricing</a><a class="navbar__item navbar__link" href="/blog/">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" buttontype="btnSecondary" href="/contact/">Contact</a><a href="https://dash.phasetwo.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link" buttontype="btnPrimary" title="Login or Register">Dashboard<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/articles/introduction/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/articles/category/json-web-tokens-jwt/">JSON Web Tokens (JWT)</a><button aria-label="Collapse sidebar category &#x27;JSON Web Tokens (JWT)&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/articles/jwts/decoding-jwt-structure/">Decoding JWT Structure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/articles/jwts/jwt-benefits-drawbacks/">Benefits and Drawbacks of JWTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/articles/jwts/jwt-security-best-practices/">Security Best Practices</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/articles/category/json-web-tokens-jwt/"><span>JSON Web Tokens (JWT)</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Security Best Practices</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>JWT Security Best Practices</h1></header>
<p>JSON Web Tokens (JWTs) are a widely adopted standard for authentication and authorization in modern web applications. Despite some criticism regarding their security, JWTs can provide robust protection when properly implemented.</p>
<p>The security of JWTs depends on careful attention to implementation details, proper cryptographic choices, and adherence to established security patterns. When these fundamentals are followed, JWTs offer a powerful and safe mechanism for managing user identity and access control.</p>
<p>This comprehensive guide examines how to implement JWTs securely across your entire application stack. We&#x27;ll explore best practices for token generation, storage, transmission, and validation, ensuring your implementation remains protected against common attack vectors.</p>
<blockquote>
<p>Note: Security requirements vary significantly between applications. A financial services platform requires different precautions than a social media app. Apply these recommendations based on your specific risk profile and compliance requirements.</p>
</blockquote>
<blockquote>
<p>Note: Throughout this guide, we&#x27;ll focus on signed JWTs i.e. the tokens that let you verify they haven&#x27;t been tampered with (like a wax seal on a letter). We won&#x27;t cover encrypted JWTs, which hide the actual contents. If you need to keep data secret, encrypted JWTs are a separate topic.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="definitions">Definitions<a href="#definitions" class="hash-link" aria-label="Direct link to Definitions" title="Direct link to Definitions">​</a></h2>
<p>Before implementing JWT authentication, it&#x27;s crucial to understand the core components and their roles:</p>
<ul>
<li><strong>Token Issuer</strong>: The authorization service responsible for generating and signing JWTs. In OAuth terminology, this is typically the Authorization Server (AS).</li>
<li><strong>Resource Server</strong>: The API or service that validates JWTs to authorize access to protected resources. In OAuth, this is the Resource Server (RS) that protects API endpoints.</li>
<li><strong>Client Application</strong>: The frontend application (web, mobile, desktop) that obtains tokens from the issuer and presents them to resource servers.</li>
<li><strong>Payload Claims</strong>: The data assertions contained within the JWT structure, including both standardized and custom information about the token subject.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-considerations">Security Considerations<a href="#security-considerations" class="hash-link" aria-label="Direct link to Security Considerations" title="Direct link to Security Considerations">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="token-transparency-and-data-exposure">Token Transparency and Data Exposure<a href="#token-transparency-and-data-exposure" class="hash-link" aria-label="Direct link to Token Transparency and Data Exposure" title="Direct link to Token Transparency and Data Exposure">​</a></h3>
<p>The fundamental security characteristic of signed JWTs is their transparency - they function like digital postcards where the content is visible to anyone who possesses the token. Here&#x27;s an example token that appears cryptic but is easily readable:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiI4NWEwMzg2Ny1kY2NmLTQ4ODItYWRkZS0xYTc5YWVlYzUwZGYiLCJleHAiOjE2NDQ4ODQxODUsImlhdCI6MTY0NDg4MDU4NSwiaXNzIjoiYWNtZS5jb20iLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJqdGkiOiIzZGQ2NDM0ZC03OWE5LTRkMTUtOThiNS03YjUxZGJiMmNkMzEiLCJhdXRoZW50aWNhdGlvblR5cGUiOiJQQVNTV09SRCIsImVtYWlsIjoiYWRtaW5AcGhhc2V0d28uaW8iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiYXBwbGljYXRpb25JZCI6Ijg1YTAzODY3LWRjY2YtNDg4Mi1hZGRlLTFhNzlhZWVjNTBkZiIsInJvbGVzIjpbImNlbyJdfQ.8DCV8fVizi3Z1EI7tTxp-kChCVhxEReraDIRSdtCMlg</span><br></span></code></pre></div></div>
<p>(You can decode this JWT interactively at <a href="https://jwt.io/#token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiI4NWEwMzg2Ny1kY2NmLTQ4ODItYWRkZS0xYTc5YWVlYzUwZGYiLCJleHAiOjE2NDQ4ODQxODUsImlhdCI6MTY0NDg4MDU4NSwiaXNzIjoiYWNtZS5jb20iLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJqdGkiOiIzZGQ2NDM0ZC03OWE5LTRkMTUtOThiNS03YjUxZGJiMmNkMzEiLCJhdXRoZW50aWNhdGlvblR5cGUiOiJQQVNTV09SRCIsImVtYWlsIjoiYWRtaW5AcGhhc2V0d28uaW8iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiYXBwbGljYXRpb25JZCI6Ijg1YTAzODY3LWRjY2YtNDg4Mi1hZGRlLTFhNzlhZWVjNTBkZiIsInJvbGVzIjpbImNlbyJdfQ.8DCV8fVizi3Z1EI7tTxp-kChCVhxEReraDIRSdtCMlg" target="_blank" rel="noopener noreferrer">jwt.io</a> using the secret: <code>b7e151628aed2a6abf7158809cf4f3c762e7160efc7e218d3f2c3b394d2d6b8f</code>.)</p>
<p>This token consists of three base64-encoded segments separated by periods: header metadata, payload claims, and cryptographic signature. The signature guarantees that the content hasn&#x27;t been modified (integrity), but anyone can decode and read the payload.</p>
<p><strong>Critical Security Principle</strong>: Exclude sensitive information such as passwords, social security numbers, payment details, or any confidential business data from JWT payloads. Consider using opaque reference tokens if you need to include sensitive information.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure-transmission-protocols">Secure Transmission Protocols<a href="#secure-transmission-protocols" class="hash-link" aria-label="Direct link to Secure Transmission Protocols" title="Direct link to Secure Transmission Protocols">​</a></h3>
<p>Protecting JWTs during transmission requires multiple layers of security:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="transport-layer-security">Transport Layer Security<a href="#transport-layer-security" class="hash-link" aria-label="Direct link to Transport Layer Security" title="Direct link to Transport Layer Security">​</a></h4>
<p>Always use TLS 1.2 or later when transmitting tokens. This encrypts the token during network transmission, preventing eavesdropping and man-in-the-middle attacks.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="http-method-considerations">HTTP Method Considerations<a href="#http-method-considerations" class="hash-link" aria-label="Direct link to HTTP Method Considerations" title="Direct link to HTTP Method Considerations">​</a></h4>
<p>Avoid including JWTs in URL parameters of GET requests, as these may be:</p>
<ul>
<li>Logged by web servers, proxies, and CDNs</li>
<li>Cached by browsers and intermediate systems</li>
<li>Leaked through referrer headers</li>
</ul>
<p>Instead, use the standard <code>Authorization: Bearer &lt;token&gt;</code> header or secure POST request bodies.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cross-origin-resource-sharing-cors">Cross-Origin Resource Sharing (CORS)<a href="#cross-origin-resource-sharing-cors" class="hash-link" aria-label="Direct link to Cross-Origin Resource Sharing (CORS)" title="Direct link to Cross-Origin Resource Sharing (CORS)">​</a></h4>
<p>When tokens must cross domain boundaries, implement strict CORS policies that explicitly allow only trusted origins. Avoid wildcard (<code>*</code>) origins in production environments.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="information-leakage-prevention">Information Leakage Prevention<a href="#information-leakage-prevention" class="hash-link" aria-label="Direct link to Information Leakage Prevention" title="Direct link to Information Leakage Prevention">​</a></h3>
<p>JWT claims can inadvertently reveal system architecture details. Use these strategies to minimize information disclosure:</p>
<ul>
<li>Replace sequential identifiers (<code>user_123</code>) with UUIDs or random strings (<code>usr_8a7b9c2d1e3f</code>)</li>
<li>Avoid exposing internal service names or database schemas</li>
<li>Use generic error messages that don&#x27;t reveal validation failure reasons</li>
<li>Implement consistent response timing to prevent timing attacks</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-tokens">Creating Tokens<a href="#creating-tokens" class="hash-link" aria-label="Direct link to Creating Tokens" title="Direct link to Creating Tokens">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="signature-algorithm-selection">Signature Algorithm Selection<a href="#signature-algorithm-selection" class="hash-link" aria-label="Direct link to Signature Algorithm Selection" title="Direct link to Signature Algorithm Selection">​</a></h3>
<p>The choice of signing algorithm impacts both security and performance characteristics of your JWT implementation.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="symmetric-signature-algorithms-hmac">Symmetric Signature Algorithms (HMAC)<a href="#symmetric-signature-algorithms-hmac" class="hash-link" aria-label="Direct link to Symmetric Signature Algorithms (HMAC)" title="Direct link to Symmetric Signature Algorithms (HMAC)">​</a></h4>
<p>HMAC-based algorithms (HS256, HS384, HS512) use shared secrets for both signing and verification.</p>
<p><strong>Performance Advantages</strong>:</p>
<ul>
<li>Fastest signing and verification operations</li>
<li>Minimal computational overhead</li>
<li>Suitable for high-throughput scenarios</li>
</ul>
<p><strong>Security Considerations</strong>:</p>
<ul>
<li>Requires secure secret distribution to all parties</li>
<li>Any party with the secret can generate valid tokens</li>
<li>Secret compromise affects all token validation</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="asymmetric-signature-algorithms-rsaecc">Asymmetric Signature Algorithms (RSA/ECC)<a href="#asymmetric-signature-algorithms-rsaecc" class="hash-link" aria-label="Direct link to Asymmetric Signature Algorithms (RSA/ECC)" title="Direct link to Asymmetric Signature Algorithms (RSA/ECC)">​</a></h4>
<p>Public-key algorithms enable distributed token validation without sharing secrets.</p>
<p><strong>RSA Algorithms</strong> (RS256, RS384, RS512):</p>
<ul>
<li>Well-established and widely supported</li>
<li>Larger key sizes required (minimum 2048 bits)</li>
<li>Slower performance, especially for signing operations</li>
</ul>
<p><strong>Elliptic Curve Algorithms</strong> (ES256, ES384, ES512):</p>
<ul>
<li>Modern cryptographic approach</li>
<li>Smaller key sizes with equivalent security</li>
<li>Better performance than RSA</li>
<li>Recommended for new implementations</li>
</ul>
<p><strong>Performance Impact</strong> (relative to HMAC baseline):</p>
<ul>
<li>HMAC: 1x signing speed, 1x verification speed</li>
<li>ECC: 2.5x signing time, 2x verification time</li>
<li>RSA: 9x signing time, comparable verification speed</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="claims-configuration-best-practices">Claims Configuration Best Practices<a href="#claims-configuration-best-practices" class="hash-link" aria-label="Direct link to Claims Configuration Best Practices" title="Direct link to Claims Configuration Best Practices">​</a></h3>
<p>While JWT specifications don&#x27;t mandate specific claims, security-focused implementations should include these registered claims:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;typ&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;JWT&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Token type in header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;alg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ES256&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Algorithm in header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;kid&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;key_2023_q4&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Key identifier in header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;iss&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://auth.yourcompany.com&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Token issuer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;aud&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;api.yourcompany.com&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Intended audience(s)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;sub&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;usr_8a7b9c2d1e3f&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Subject (user ID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;exp&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1688127056</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Expiration timestamp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;nbf&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1688123456</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Not before timestamp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;iat&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1688123456</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Issued at timestamp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;jti&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;uuid-4a5b6c7d8e9f&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Unique token ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="essential-claim-requirements">Essential Claim Requirements<a href="#essential-claim-requirements" class="hash-link" aria-label="Direct link to Essential Claim Requirements" title="Direct link to Essential Claim Requirements">​</a></h4>
<p><strong>Issuer (<code>iss</code>) Validation</strong>: Use a consistent, unique identifier that doesn&#x27;t expose internal system details. This enables consumers to verify token origin.</p>
<p><strong>Audience (<code>aud</code>) Specification</strong>: Prevents token misuse across different services by explicitly defining intended recipients. Can be a string or array of strings.</p>
<p><strong>Expiration (<code>exp</code>) Management</strong>: Set aggressive expiration times measured in minutes or hours rather than days. Short-lived tokens reduce the impact of token theft.</p>
<p><strong>Unique Identifier (<code>jti</code>)</strong>: Enables token tracking and revocation. Use cryptographically random values to prevent enumeration attacks.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="token-revocation-strategies">Token Revocation Strategies<a href="#token-revocation-strategies" class="hash-link" aria-label="Direct link to Token Revocation Strategies" title="Direct link to Token Revocation Strategies">​</a></h3>
<p>Stateless JWTs present revocation challenges that require strategic approaches:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="short-token-lifetimes">Short Token Lifetimes<a href="#short-token-lifetimes" class="hash-link" aria-label="Direct link to Short Token Lifetimes" title="Direct link to Short Token Lifetimes">​</a></h4>
<p>Issue access tokens with 15-30 minute expiration times. This naturally limits exposure windows while maintaining performance benefits.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="refresh-token-pattern">Refresh Token Pattern<a href="#refresh-token-pattern" class="hash-link" aria-label="Direct link to Refresh Token Pattern" title="Direct link to Refresh Token Pattern">​</a></h4>
<ul>
<li>Provide separate, longer-lived refresh tokens for obtaining new access tokens</li>
<li>Store refresh tokens securely and implement revocation lists</li>
<li>Rotate refresh tokens on each use to detect replay attacks</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="distributed-blacklisting">Distributed Blacklisting<a href="#distributed-blacklisting" class="hash-link" aria-label="Direct link to Distributed Blacklisting" title="Direct link to Distributed Blacklisting">​</a></h4>
<p>Maintain a shared cache of revoked token identifiers (<code>jti</code> claims) that all resource servers check during validation. This introduces some statefulness but enables immediate revocation.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="emergency-key-rotation">Emergency Key Rotation<a href="#emergency-key-rotation" class="hash-link" aria-label="Direct link to Emergency Key Rotation" title="Direct link to Emergency Key Rotation">​</a></h4>
<p>For security incidents, rotate signing keys to immediately invalidate all outstanding tokens. Implement overlapping key validity periods to ensure seamless transitions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-management-framework">Key Management Framework<a href="#key-management-framework" class="hash-link" aria-label="Direct link to Key Management Framework" title="Direct link to Key Management Framework">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="secret-generation-requirements">Secret Generation Requirements<a href="#secret-generation-requirements" class="hash-link" aria-label="Direct link to Secret Generation Requirements" title="Direct link to Secret Generation Requirements">​</a></h4>
<p><strong>HMAC Secret Standards</strong>:</p>
<ul>
<li>Minimum length equal to hash output (256 bits for HS256)</li>
<li>Use cryptographically secure random number generators</li>
<li>Never reuse secrets across different applications or environments</li>
</ul>
<p><strong>RSA Key Standards</strong>:</p>
<ul>
<li>Minimum 2048 bits for existing systems</li>
<li>Prefer 3072 bits or higher for new implementations</li>
<li>Generate keys using established cryptographic libraries</li>
</ul>
<p><strong>ECC Key Standards</strong>:</p>
<ul>
<li>Use standardized curves: P-256, P-384, or P-521</li>
<li>Avoid non-standard or experimental curves</li>
<li>Ensure proper random number generation during key creation</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-lifecycle-management">Key Lifecycle Management<a href="#key-lifecycle-management" class="hash-link" aria-label="Direct link to Key Lifecycle Management" title="Direct link to Key Lifecycle Management">​</a></h4>
<p><strong>Automated Rotation Schedules</strong>:</p>
<ul>
<li>Implement monthly or quarterly key rotation for production systems</li>
<li>Use deployment automation to minimize manual intervention</li>
<li>Maintain rotation logs for compliance and audit purposes</li>
</ul>
<p><strong>Multi-Key Support</strong>:</p>
<ul>
<li>Support multiple concurrent signing keys during rotation periods</li>
<li>Use <code>kid</code> (Key ID) header parameters for key identification</li>
<li>Implement graceful fallback for old key validation</li>
</ul>
<p><strong>Emergency Procedures</strong>:</p>
<ul>
<li>Prepare rapid key rotation procedures for security incidents</li>
<li>Test emergency rotation in non-production environments</li>
<li>Document communication procedures for coordinated key updates</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="holding-tokens">Holding Tokens<a href="#holding-tokens" class="hash-link" aria-label="Direct link to Holding Tokens" title="Direct link to Holding Tokens">​</a></h2>
<p>Client applications bear responsibility for secure token storage and transmission. Storage strategies must account for the specific capabilities and threat models of different client types.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="web-application-storage">Web Application Storage<a href="#web-application-storage" class="hash-link" aria-label="Direct link to Web Application Storage" title="Direct link to Web Application Storage">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="secure-cookie-implementation-recommended">Secure Cookie Implementation (Recommended)<a href="#secure-cookie-implementation-recommended" class="hash-link" aria-label="Direct link to Secure Cookie Implementation (Recommended)" title="Direct link to Secure Cookie Implementation (Recommended)">​</a></h4>
<p>Configure cookies with comprehensive security attributes:</p>
<div class="language-http codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-http codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Set-Cookie: access_token=&lt;jwt_token&gt;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Secure;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  HttpOnly;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  SameSite=Strict;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Path=/;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Max-Age=3600;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  Domain=.yourcompany.com</span><br></span></code></pre></div></div>
<p><strong>Security Benefits</strong>:</p>
<ul>
<li><code>HttpOnly</code> prevents JavaScript access, mitigating XSS attacks</li>
<li><code>Secure</code> ensures transmission only over HTTPS connections</li>
<li><code>SameSite=Strict</code> provides CSRF protection for same-site requests</li>
<li>Automatic transmission eliminates manual header management</li>
</ul>
<p><strong>Limitations</strong>:</p>
<ul>
<li>Restricted to same-domain API requests</li>
<li>Requires server-side session infrastructure for cross-domain scenarios</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="backend-for-frontend-bff-architecture">Backend-for-Frontend (BFF) Architecture<a href="#backend-for-frontend-bff-architecture" class="hash-link" aria-label="Direct link to Backend-for-Frontend (BFF) Architecture" title="Direct link to Backend-for-Frontend (BFF) Architecture">​</a></h4>
<p>Implement server-side token storage with session-based client communication:</p>
<p><strong>Implementation Pattern</strong>:</p>
<ol>
<li>Authentication server issues tokens to your backend service</li>
<li>Backend stores tokens in secure server-side sessions</li>
<li>Client receives session cookies instead of raw tokens</li>
<li>Backend proxies API requests using stored tokens</li>
</ol>
<p><strong>Security Advantages</strong>:</p>
<ul>
<li>Complete token isolation from client-side threats</li>
<li>Simplified revocation through session termination</li>
<li>Works across multiple domains and services</li>
<li>Eliminates client-side token exposure</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mobile-application-storage">Mobile Application Storage<a href="#mobile-application-storage" class="hash-link" aria-label="Direct link to Mobile Application Storage" title="Direct link to Mobile Application Storage">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ios-secure-storage">iOS Secure Storage<a href="#ios-secure-storage" class="hash-link" aria-label="Direct link to iOS Secure Storage" title="Direct link to iOS Secure Storage">​</a></h4>
<p>Utilize iOS Keychain with appropriate accessibility settings:</p>
<div class="language-swift codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-swift codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">let</span><span class="token plain"> query</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token class-name" style="color:rgb(255, 203, 107)">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">Any</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">kSecClass</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">kSecClassGenericPassword</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">kSecAttrAccount</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string-literal string" style="color:rgb(195, 232, 141)">&quot;jwt_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">kSecAttrAccessible</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">kSecAttrAccessibleWhenUnlockedThisDeviceOnly</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token constant" style="color:rgb(130, 170, 255)">kSecValueData</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">String</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tokenData</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="android-secure-storage">Android Secure Storage<a href="#android-secure-storage" class="hash-link" aria-label="Direct link to Android Secure Storage" title="Direct link to Android Secure Storage">​</a></h4>
<p>Implement EncryptedSharedPreferences or Android Keystore:</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">val</span><span class="token plain"> masterKey </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> MasterKey</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">Builder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">setKeyScheme</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">MasterKey</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">KeyScheme</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">AES256_GCM</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">val</span><span class="token plain"> sharedPreferences </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> EncryptedSharedPreferences</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">create</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string-literal singleline string" style="color:rgb(195, 232, 141)">&quot;jwt_prefs&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    masterKey</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EncryptedSharedPreferences</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">PrefKeyEncryptionScheme</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">AES256_SIV</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    EncryptedSharedPreferences</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">PrefValueEncryptionScheme</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">AES256_GCM</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cross-platform-solutions">Cross-Platform Solutions<a href="#cross-platform-solutions" class="hash-link" aria-label="Direct link to Cross-Platform Solutions" title="Direct link to Cross-Platform Solutions">​</a></h4>
<p>For React Native and similar frameworks, use specialized secure storage libraries:</p>
<ul>
<li><code>react-native-keychain</code> for iOS/Android keychain access</li>
<li><code>expo-secure-store</code> for Expo applications</li>
<li>Platform-specific secure storage wrappers</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-security-comparison">Storage Security Comparison<a href="#storage-security-comparison" class="hash-link" aria-label="Direct link to Storage Security Comparison" title="Direct link to Storage Security Comparison">​</a></h3>
<table><thead><tr><th>Storage Method</th><th>XSS Protection</th><th>CSRF Protection</th><th>Cross-Domain Support</th><th>Revocation Ease</th><th>Performance Impact</th></tr></thead><tbody><tr><td>Secure Cookies</td><td>✅ High</td><td>✅ High</td><td>❌ Limited</td><td>🟡 Moderate</td><td>✅ Minimal</td></tr><tr><td>BFF/Sessions</td><td>✅ Complete</td><td>✅ High</td><td>✅ Full</td><td>✅ Easy</td><td>🟡 Moderate</td></tr><tr><td>Native Secure Storage</td><td>✅ Complete</td><td>N/A</td><td>✅ Full</td><td>🟡 Moderate</td><td>✅ Minimal</td></tr><tr><td>In-Memory Storage</td><td>🟡 Partial</td><td>✅ High</td><td>✅ Full</td><td>❌ Difficult</td><td>✅ Minimal</td></tr><tr><td>Local Storage</td><td>❌ Vulnerable</td><td>✅ High</td><td>✅ Full</td><td>❌ Difficult</td><td>✅ Minimal</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="consuming-a-jwt">Consuming a JWT<a href="#consuming-a-jwt" class="hash-link" aria-label="Direct link to Consuming a JWT" title="Direct link to Consuming a JWT">​</a></h2>
<p>Resource servers must implement comprehensive token validation to ensure security and prevent common attack vectors.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="comprehensive-validation-framework">Comprehensive Validation Framework<a href="#comprehensive-validation-framework" class="hash-link" aria-label="Direct link to Comprehensive Validation Framework" title="Direct link to Comprehensive Validation Framework">​</a></h3>
<p>Implement a multi-stage validation process that checks all aspects of token integrity and authenticity:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">validate_jwt_token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> expected_issuer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> expected_audience</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> allowed_algorithms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Comprehensive JWT validation with security-first approach</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">try</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Stage 1: Structure validation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> token </span><span class="token keyword" style="font-style:italic">or</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Invalid token structure&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> signature </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;.&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Stage 2: Header validation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        header_data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> decode_base64_json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">header</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        algorithm </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> header_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;alg&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> algorithm </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;none&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Unsigned tokens rejected&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> algorithm </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> allowed_algorithms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Algorithm not permitted&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Stage 3: Signature verification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        public_key </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_public_key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">header_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;kid&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> verify_signature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> public_key</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> algorithm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Signature verification failed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Stage 4: Claims validation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        claims </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> decode_base64_json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        current_time </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_current_timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        clock_skew </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">60</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Allow 60-second clock skew</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Timing validations</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;exp&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> clock_skew </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> current_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Token expired&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;nbf&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> clock_skew </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> current_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Token not yet valid&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Issuer validation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;iss&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">!=</span><span class="token plain"> expected_issuer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Invalid issuer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Audience validation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        token_audiences </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;aud&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">isinstance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">token_audiences</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            token_audiences </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">token_audiences</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> expected_audience </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> token_audiences</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Invalid audience&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Optional: Revocation check</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> is_token_revoked</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;jti&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Token revoked&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> claims</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">except</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">except</span><span class="token plain"> Exception </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Log technical details internally, return generic error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log_security_event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jwt_validation_error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">e</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">raise</span><span class="token plain"> ValidationError</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Token validation failed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="algorithm-security-verification">Algorithm Security Verification<a href="#algorithm-security-verification" class="hash-link" aria-label="Direct link to Algorithm Security Verification" title="Direct link to Algorithm Security Verification">​</a></h3>
<p>Prevent algorithm confusion attacks by explicitly validating the signing algorithm:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">verify_algorithm_security</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">header_algorithm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> expected_algorithms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Prevent algorithm downgrade and confusion attacks</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Reject unsigned tokens</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> header_algorithm </span><span class="token operator" style="color:rgb(137, 221, 255)">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;none&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Verify algorithm is in allowlist</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> header_algorithm </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> expected_algorithms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Prevent HMAC/RSA confusion for asymmetric keys</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> header_algorithm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;HS&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">and</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;RS&#x27;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> expected_algorithms</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="claims-sanitization-and-validation">Claims Sanitization and Validation<a href="#claims-sanitization-and-validation" class="hash-link" aria-label="Direct link to Claims Sanitization and Validation" title="Direct link to Claims Sanitization and Validation">​</a></h3>
<p>Sanitize all claim values before using them in business logic:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">sanitize_jwt_claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Sanitize JWT claims for safe application use</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    sanitized </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Validate and sanitize user identifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    user_id </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;sub&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> user_id </span><span class="token keyword" style="font-style:italic">and</span><span class="token plain"> is_valid_user_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        sanitized</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;user_id&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> escape_sql_injection</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">user_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Validate and sanitize custom claims</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> claim_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> claim_value </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> claims</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">items</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> claim_name </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> ALLOWED_CUSTOM_CLAIMS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            sanitized</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">claim_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sanitize_claim_value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">claim_value</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> sanitized</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling-security">Error Handling Security<a href="#error-handling-security" class="hash-link" aria-label="Direct link to Error Handling Security" title="Direct link to Error Handling Security">​</a></h3>
<p>Implement consistent error responses that don&#x27;t leak validation details:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">handle_jwt_validation_error</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">error_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> request_context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    Provide consistent error responses regardless of validation failure type</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Log detailed error internally</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log_security_event</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;jwt_validation_failure&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;error_type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> error_type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client_ip&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> request_context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;client_ip&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timestamp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> get_current_timestamp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user_agent&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> request_context</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;user_agent&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Return generic error to client</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;error&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;invalid_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;error_description&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;The provided token is invalid&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">401</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-optimization">Performance Optimization<a href="#performance-optimization" class="hash-link" aria-label="Direct link to Performance Optimization" title="Direct link to Performance Optimization">​</a></h3>
<p>Optimize validation performance while maintaining security:</p>
<ul>
<li><strong>Cache public keys</strong> with appropriate TTL values</li>
<li><strong>Implement connection pooling</strong> for key retrieval services</li>
<li><strong>Use efficient JSON parsing</strong> libraries</li>
<li><strong>Cache validation results</strong> for identical tokens (with short TTL)</li>
<li><strong>Implement circuit breakers</strong> for external key services</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Building secure JWT authentication involves methodically addressing each phase of the token lifecycle. This guide has covered key strategies and patterns that you can use to develop production systems that effectively utilize JWTs while maintaining robust security.</p>
<p>Working with JWTs requires a solid grasp of their core concepts, proper validation approaches, and disciplined operational practices. To maintain security over time, implement regular reviews, monitor for new threats, and update your implementation as industry best practices evolve.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc7519" target="_blank" rel="noopener noreferrer">RFC 7519: JSON Web Token (JWT)</a></li>
<li><a href="https://tools.ietf.org/html/rfc7515" target="_blank" rel="noopener noreferrer">RFC 7515: JSON Web Signature (JWS)</a></li>
<li><a href="https://tools.ietf.org/html/rfc8725" target="_blank" rel="noopener noreferrer">RFC 8725: JSON Web Token Best Current Practices</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">OWASP JWT Security Cheat Sheet</a></li>
<li><a href="https://tools.ietf.org/html/rfc7517" target="_blank" rel="noopener noreferrer">JSON Web Key (JWK) Specification</a></li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/articles/jwts/jwt-benefits-drawbacks/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Benefits and Drawbacks of JWTs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#definitions" class="table-of-contents__link toc-highlight">Definitions</a></li><li><a href="#security-considerations" class="table-of-contents__link toc-highlight">Security Considerations</a><ul><li><a href="#token-transparency-and-data-exposure" class="table-of-contents__link toc-highlight">Token Transparency and Data Exposure</a></li><li><a href="#secure-transmission-protocols" class="table-of-contents__link toc-highlight">Secure Transmission Protocols</a></li><li><a href="#information-leakage-prevention" class="table-of-contents__link toc-highlight">Information Leakage Prevention</a></li></ul></li><li><a href="#creating-tokens" class="table-of-contents__link toc-highlight">Creating Tokens</a><ul><li><a href="#signature-algorithm-selection" class="table-of-contents__link toc-highlight">Signature Algorithm Selection</a></li><li><a href="#claims-configuration-best-practices" class="table-of-contents__link toc-highlight">Claims Configuration Best Practices</a></li><li><a href="#token-revocation-strategies" class="table-of-contents__link toc-highlight">Token Revocation Strategies</a></li><li><a href="#key-management-framework" class="table-of-contents__link toc-highlight">Key Management Framework</a></li></ul></li><li><a href="#holding-tokens" class="table-of-contents__link toc-highlight">Holding Tokens</a><ul><li><a href="#web-application-storage" class="table-of-contents__link toc-highlight">Web Application Storage</a></li><li><a href="#mobile-application-storage" class="table-of-contents__link toc-highlight">Mobile Application Storage</a></li><li><a href="#storage-security-comparison" class="table-of-contents__link toc-highlight">Storage Security Comparison</a></li></ul></li><li><a href="#consuming-a-jwt" class="table-of-contents__link toc-highlight">Consuming a JWT</a><ul><li><a href="#comprehensive-validation-framework" class="table-of-contents__link toc-highlight">Comprehensive Validation Framework</a></li><li><a href="#algorithm-security-verification" class="table-of-contents__link toc-highlight">Algorithm Security Verification</a></li><li><a href="#claims-sanitization-and-validation" class="table-of-contents__link toc-highlight">Claims Sanitization and Validation</a></li><li><a href="#error-handling-security" class="table-of-contents__link toc-highlight">Error Handling Security</a></li><li><a href="#performance-optimization" class="table-of-contents__link toc-highlight">Performance Optimization</a></li></ul></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><div><noscript>Free cookie consent management tool by
        <a href="https://www.termsfeed.com/">TermsFeed</a></noscript></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Phase Two</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/company/about/">About</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/company/careers/">Careers</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Product</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" activebasepath="hosting" href="/hosting/">Hosting</a></li><li class="footer__item"><a class="footer__link-item" activebasepath="product/sso" href="/product/sso/">SSO</a></li><li class="footer__item"><a class="footer__link-item" activebasepath="product/identity" href="/product/identity/">Identity</a></li><li class="footer__item"><a class="footer__link-item" activebasepath="product/organizations" href="/product/organizations/">Organizations</a></li><li class="footer__item"><a class="footer__link-item" activebasepath="product/adminportal" href="/product/adminportal/">Admin Portal</a></li><li class="footer__item"><a class="footer__link-item" activebasepath="product/onprem" href="/product/onprem/">On-Prem</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Developers</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/api/phase-two-admin-rest-api/">API</a></li><li class="footer__item"><a href="https://github.com/p2-inc" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/support/migrate-to-keycloak/">Migrate to Keycloak</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Support</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/contact/">Contact</a></li><li class="footer__item"><a class="footer__link-item" href="/support/">Enterprise Support</a></li><li class="footer__item"><a href="https://github.com/p2-inc/phasetwo/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bugs &amp; Feature Requests<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="mailto:support@phasetwo.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">support@phasetwo.io<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://dev.to/phasetwo" target="_blank" rel="noopener noreferrer" class="footer__link-item">DEV.to<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCUY2ZvxI0hxpTWO_8w7MjVw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://trust.phasetwo.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trust Center<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/company/privacy/">Privacy Policy</a></li><li class="footer__item"><a class="footer__link-item" href="/company/terms/">Terms of Use</a></li><li class="footer__item"><a class="footer__link-item" href="/company/subprocessors/">Subprocessors</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/subprocessors/">Subprocessors</a></li><li class="footer__item"><a class="footer__link-item" href="/company/service-agreement/">Service Agreement</a></li><li class="footer__item"><a class="footer__link-item" href="/company/sla/">SLA</a></li><li class="footer__item"><a href="#open_preferences_center" class="footer__link-item" id="open_preferences_center">Cookies Policy</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title"> </div><ul class="footer__items clean-list"><li class="footer__item">
                <img class="footer-logo" src="/img/logo_phase_slash.svg" alt="PhaseTwo" width="114" height="51">
              </li><li class="footer__item">
                <img class="soc-2-footer" src="/img/soc2_type1/SOC 2 T1 Logo Rectangle Black.png" alt="SOC 2 Type 1" width="114" height="auto">
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Phase Two, Inc.</div></div></div></footer></div>
</body>
</html>