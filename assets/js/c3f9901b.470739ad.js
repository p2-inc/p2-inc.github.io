"use strict";(globalThis.webpackChunkphasetwo_docs=globalThis.webpackChunkphasetwo_docs||[]).push([[11236],{6899(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/2.configurable-active-organization-mapper-baa3bcf033bacdc913077b60c33a7a9a.png"},20831(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>p});const i=JSON.parse('{"id":"organizations/token-mappers","title":"Token Mappers","description":"Token mappers allow you to map information about the user, their organization, or other attributes into the access token, ID token, or userinfo endpoint response. This can be useful for applications that need to know about the user\'s organization or other attributes in order to make authorization decisions.","source":"@site/docs/organizations/token-mappers.md","sourceDirName":"organizations","slug":"/organizations/token-mappers","permalink":"/docs/organizations/token-mappers","draft":false,"unlisted":false,"editUrl":"https://github.com/p2-inc/phasetwo-docs/tree/main/docs/organizations/token-mappers.md","tags":[],"version":"current","frontMatter":{"id":"token-mappers","title":"Token Mappers","sidebar_label":"Token Mappers"},"sidebar":"docs","previous":{"title":"Admin Portal","permalink":"/docs/admin-portal/"},"next":{"title":"Active Organization","permalink":"/docs/organizations/active-organization"}}');var a=t(86070),o=t(49531);const r={id:"token-mappers",title:"Token Mappers",sidebar_label:"Token Mappers"},s=void 0,c={},p=[{value:"Configure the mapper",id:"configure-the-mapper",level:3}];function l(e){const n={a:"a",br:"br",code:"code",em:"em",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["Token mappers allow you to map information about the user, their organization, or other attributes into the access token, ID token, or ",(0,a.jsx)(n.code,{children:"userinfo"})," endpoint response. This can be useful for applications that need to know about the user's organization or other attributes in order to make authorization decisions."]}),"\n",(0,a.jsxs)(n.p,{children:["You can create a mapping at the realm level or the client level, depending on your needs. The process is the same. The following overlaps with configuration of the ",(0,a.jsx)(n.a,{href:"/docs/organizations/active-organization",children:"active organization mapper"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"configure-the-mapper",children:"Configure the mapper"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"1. Create client scope"})}),"\n",(0,a.jsx)(n.p,{children:"In your realm Client scopes, add a new client-scope, set the configuration and name as you wish."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"client-scope",src:t(84902).A+"",width:"2164",height:"1696"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"2. Use an organization mapper"})}),"\n",(0,a.jsx)(n.p,{children:'Phase Two provides predefined mappers for organization information, but you can also create your own custom mappers if you need to map other information. Select "Configure a new mapper" adn from the list you can select'}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"/docs/organizations/active-organization",children:"Active Organization"})}),"\n",(0,a.jsx)(n.li,{children:"Organization Attribute"}),"\n",(0,a.jsx)(n.li,{children:"Organization Role"}),"\n",(0,a.jsx)(n.li,{children:"Organization Specific Attribute"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:'For example the "Active Organization" mapper,'}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"available-mapper",src:t(6899).A+"",width:"813",height:"170"})}),"\n",(0,a.jsx)(n.p,{children:"On the add mapper screen, adjust as needed."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"add-mapper",src:t(41140).A+"",width:"2116",height:"1476"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"3. Configure the mapper"})}),"\n",(0,a.jsx)(n.p,{children:"By default, all properties are pre-configured. You can remove what you want and the mapper will adjust the claim."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.em,{children:"Example with all pre-configured properties"}),":",(0,a.jsx)(n.br,{}),"\n",(0,a.jsx)(n.img,{alt:"mapper-configuration",src:t(30706).A+"",width:"598",height:"715"})]}),"\n",(0,a.jsx)(n.p,{children:"Will produce this claim in token:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'  "active_organization": {\n    "role": [\n      "view-organization",\n      "view-members",\n      "view-roles"\n    ],\n    "name": "My Organization",\n    "id": "75bc86cb-8527-43af-b598-0873fa2bfea6",\n    "attribute": {\n      "test": [\n        "test"\n      ]\n    }\n  },\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.em,{children:"Example with only id property"}),":",(0,a.jsx)(n.br,{}),"\n",(0,a.jsx)(n.img,{alt:"mapper-configuration",src:t(67979).A+"",width:"598",height:"674"})]}),"\n",(0,a.jsx)(n.p,{children:"Will produce this claim in token:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'  "active_organization": {\n    "id": "75bc86cb-8527-43af-b598-0873fa2bfea6"\n  },\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"4. Add new client scope to public client"})}),"\n",(0,a.jsx)(n.p,{children:"On your public client (used by your FE application) add the newly created client scope."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"client-client-scopes",src:t(75043).A+"",width:"858",height:"504"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"5. Token claims"}),(0,a.jsx)(n.br,{}),"\n","Then, after authentication, you should have the active organization info into the token claims."]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"token-claims",src:t(61597).A+"",width:"443",height:"303"})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},30706(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/3.mapper-configuration-e1abfdea6c975975e30de2c67c21b776.png"},41140(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/add-mapper-c83f6f3186d66b676440614057178d7f.png"},49531(e,n,t){t.d(n,{R:()=>r,x:()=>s});var i=t(30758);const a={},o=i.createContext(a);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},61597(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/5.token-claims-016e6439a145aabcebd920cbfd9162fc.png"},67979(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/3.1.mapper-configuration-5fb3b4a774243f7360c13f6cc65b0ce7.png"},75043(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/4.configure-client-client-scopes-2e4481ca4d71545dec90250c29ea412a.png"},84902(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/create-client-scope-33a10b3f3ad0c8dd5da68fd531461c4a.png"}}]);