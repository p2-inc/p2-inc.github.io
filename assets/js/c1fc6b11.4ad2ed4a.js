"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[4647],{3905:function(t,e,i){i.d(e,{Zo:function(){return p},kt:function(){return h}});var n=i(67294);function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e){if(null==t)return{};var i,n,a=function(t,e){if(null==t)return{};var i,n,a={},r=Object.keys(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||(a[i]=t[i]);return a}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)i=r[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(a[i]=t[i])}return a}var l=n.createContext({}),c=function(t){var e=n.useContext(l),i=e;return t&&(i="function"==typeof t?t(e):o(o({},e),t)),i},p=function(t){var e=c(t.components);return n.createElement(l.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(t,e){var i=t.components,a=t.mdxType,r=t.originalType,l=t.parentName,p=s(t,["components","mdxType","originalType","parentName"]),d=c(i),h=a,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||r;return i?n.createElement(m,o(o({ref:e},p),{},{components:i})):n.createElement(m,o({ref:e},p))}));function h(t,e){var i=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var r=i.length,o=new Array(r);o[0]=d;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s.mdxType="string"==typeof t?t:a,o[1]=s;for(var c=2;c<r;c++)o[c]=i[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,i)}d.displayName="MDXCreateElement"},94618:function(t,e,i){i.r(e),i.d(e,{assets:function(){return l},contentTitle:function(){return o},default:function(){return u},frontMatter:function(){return r},metadata:function(){return s},toc:function(){return c}});var n=i(83117),a=(i(67294),i(3905));const r={id:"invitations",title:"Invitations"},o=void 0,s={unversionedId:"organizations/invitations",id:"organizations/invitations",title:"Invitations",description:"Invitations provide a way to allow Keycloak and organization administrators to invite new members to the organization.",source:"@site/docs/organizations/invitations.md",sourceDirName:"organizations",slug:"/organizations/invitations",permalink:"/docs/organizations/invitations",draft:!1,editUrl:"https://github.com/p2-inc/phasetwo-docs/tree/main/docs/organizations/invitations.md",tags:[],version:"current",frontMatter:{id:"invitations",title:"Invitations"},sidebar:"docs",previous:{title:"Membership",permalink:"/docs/organizations/membership"},next:{title:"Roles",permalink:"/docs/organizations/roles"}},l={},c=[{value:"Setup",id:"setup",level:3},{value:"Options for user registration",id:"options-for-user-registration",level:3},{value:"Self-registration",id:"self-registration",level:4},{value:"Magic-Link",id:"magic-link",level:4},{value:"API access",id:"api-access",level:3}],p={toc:c};function u(t){let{components:e,...r}=t;return(0,a.kt)("wrapper",(0,n.Z)({},p,r,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Invitations provide a way to allow Keycloak and organization administrators to invite new members to the organization.\nInvitations can be managed by the Keycloak admin in the Organizations tab of the Admin UI. You can enable organization administrators to manage invitations using the organization portal or building it into your application using the API."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Keycloak Phase Two Organizations Invites",src:i(6754).Z,width:"795",height:"450"})),(0,a.kt)("h3",{id:"setup"},"Setup"),(0,a.kt)("p",null,"Invitees may or may not be existing users. If you choose to allow invitations to emails that are not represented by existing users, you must allow registration to your application, or use an authentication flow that automatically creates user accounts (such as ",(0,a.kt)("a",{parentName:"p",href:"/docs/authentication/magic-links"},"magic link")," authentication)."),(0,a.kt)("p",null,"It is possible to pre-select any roles for a user by passing the ",(0,a.kt)("inlineCode",{parentName:"p"},"roles")," array in the API (pre-selecting in the Admin UI is currently not implemented). This will automatically add the user to the given roles upon user creation and acceptance of the invitation."),(0,a.kt)("p",null,"Adapt the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/p2-inc/keycloak-orgs?tab=readme-ov-file#authentication"},"Authentication")," according to your needs."),(0,a.kt)("p",null,"Note: Users must have a verified email address to accept an invitation, as it presents a security issue to allow any User to register with an unverified email address and claim the invitation."),(0,a.kt)("p",null,"Following user creation and authentication, invitees will be prompted to accept or decline any outstanding invitations. In addition to any roles that were selected in the invitation, the user will automatically be added as a member to the inviting organization."),(0,a.kt)("h3",{id:"options-for-user-registration"},"Options for user registration"),(0,a.kt)("h4",{id:"self-registration"},"Self-registration"),(0,a.kt)("p",null,"This option requires either creating users on behalf of them before sending the invitation or enabling user registration on the realm."),(0,a.kt)("p",null,"Invitees will receive an email indicating the realm, organization and inviter. It is possible to add a specific application redirect URI so that they will be redirected to a specific location in the application."),(0,a.kt)("h4",{id:"magic-link"},"Magic-Link"),(0,a.kt)("p",null,"This approach uses another extension in order to provide a ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/p2-inc/keycloak-magic-link"},"magic link")," that will first register the user, authenticate them, and then present them with the required action to accept the invitation. This approach is preferred when user registration is disabled. It requires the following steps:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://phasetwo.io/api/create-magic-link"},"Create a magic link")," using ",(0,a.kt)("inlineCode",{parentName:"li"},"force_create=true")," (to create a user if one does not exist) and ",(0,a.kt)("inlineCode",{parentName:"li"},"send_email=false")," to skip sending the magic link to the user."),(0,a.kt)("li",{parentName:"ul"},"Use the returned magic link when ",(0,a.kt)("a",{parentName:"li",href:"https://phasetwo.io/api/add-organization-invitation"},"creating an invitation"),". Set the ",(0,a.kt)("inlineCode",{parentName:"li"},"redirectUri={magic-link}"),".")),(0,a.kt)("h3",{id:"api-access"},"API access"),(0,a.kt)("p",null,"It is possible to ",(0,a.kt)("a",{parentName:"p",href:"/api/add-organization-invitation"},"create"),", ",(0,a.kt)("a",{parentName:"p",href:"/api/remove-organization-invitation"},"remove pending")," and ",(0,a.kt)("a",{parentName:"p",href:"/api/get-organization-invitations"},"fetch all outstanding")," organization invitations using the API."))}u.isMDXComponent=!0},6754:function(t,e,i){e.Z=i.p+"assets/images/organizations-invitations-invite-ff7880e50b1b2568ee4758b2a6ffe7c0.png"}}]);