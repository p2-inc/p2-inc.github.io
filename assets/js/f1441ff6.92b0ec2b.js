"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[4693],{28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>r});var t=n(96540);const i={},a=t.createContext(i);function o(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:s},e.children)}},36595:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>t,toc:()=>h});var t=n(90211),i=n(74848),a=n(28453);const o={title:"SAML, Simplified.",slug:"introduction-to-simple-saml",date:new Date("2025-04-10T00:00:00.000Z"),authors:"phasetwo",tags:["phase_two","open_source","saml","authentication"]},r=void 0,l={authorsImageUrls:[void 0]},h=[{value:"What even is SAML?",id:"what-even-is-saml",level:3},{value:"Keycloak and SAML",id:"keycloak-and-saml",level:3},{value:"The SAML Triad: User, SP, IdP",id:"the-saml-triad-user-sp-idp",level:3},{value:"What does a SAML flow look like in Keycloak?",id:"what-does-a-saml-flow-look-like-in-keycloak",level:3},{value:"SAML messages: what you&#39;re actually passing around",id:"saml-messages-what-youre-actually-passing-around",level:3},{value:"The SAML Request",id:"the-saml-request",level:4},{value:"The SAML Response",id:"the-saml-response",level:4},{value:"Trust is everything",id:"trust-is-everything",level:3},{value:"But...why use SAML in 2025?",id:"butwhy-use-saml-in-2025",level:3},{value:"Why let keycloak handle SAML?",id:"why-let-keycloak-handle-saml",level:3}];function d(e){const s={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.p,{children:["SAML has a bit of a reputation. For many developers, it lives in that shadowy corner of the B2B internet where XML still rules and stack traces seem to go on forever. If you've ever had the misfortune of debugging a malformed ",(0,i.jsx)(s.code,{children:"<Assertion>"}),", you know the pain. But here's the thing: it doesn't have to be a nightmare."]}),"\n",(0,i.jsxs)(s.p,{children:["At Phase Two, we provide ",(0,i.jsx)(s.a,{href:"/hosting",children:"managed hosting"})," and ",(0,i.jsx)(s.a,{href:"/support",children:"enterprise support"})," for ",(0,i.jsx)(s.a,{href:"https://www.keycloak.org/",children:"Keycloak"}),", a leading open-source Identity and Access Management platform. And while ",(0,i.jsx)(s.a,{href:"https://openid.net/specs/openid-connect-core-1_0-final.html",children:"OIDC"})," has become the default for most modern applications, ",(0,i.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/SAML_2.0",children:"SAML"})," is still alive and well\u2014especially in enterprise environments."]}),"\n",(0,i.jsxs)(s.p,{children:["This post is a gentle (and opinionated) introduction to what SAML is, how it works, and why it still matters particularly if you're implementing SAML ",(0,i.jsx)(s.a,{href:"/product/sso/",children:"SSO"})," in Keycloak."]}),"\n",(0,i.jsx)(s.h3,{id:"what-even-is-saml",children:"What even is SAML?"}),"\n",(0,i.jsx)(s.p,{children:"SAML \u2014 short for Security Assertion Markup Language \u2014 is a standardized XML-based protocol used to exchange authentication and authorization data between parties, most commonly between an Identity Provider (IdP) and a Service Provider (SP)."}),"\n",(0,i.jsx)(s.p,{children:"The core idea? Let users log in once (with the IdP) and then access multiple systems (the SPs) without re-authenticating. That's Single Sign-On (SSO), and it's where SAML shines."}),"\n",(0,i.jsx)(s.p,{children:"To make this concrete, imagine you're using Google Workspace to access your company's internal tools. You open up a tool like Jira (that's the Service Provider \u2014 it provides the service you want to use). But instead of logging in directly, you're redirected to Google to sign in \u2014 that's your Identity Provider. Google verifies who you are, then sends a message back to Jira saying, \u201cYes, this is the correct user, and here's some information about them.\u201d The service (Jira) trusts that identity because it already trusts Google. In simple terms: the IdP is who you log in with, the SP is what you're trying to access."}),"\n",(0,i.jsx)(s.h3,{id:"keycloak-and-saml",children:"Keycloak and SAML"}),"\n",(0,i.jsx)(s.p,{children:"Keycloak supports both sides of the SAML flow. It can act as:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["A ",(0,i.jsx)(s.strong,{children:"SAML Identity Provider"}),", enabling users to authenticate in Keycloak and then access SAML-based applications."]}),"\n",(0,i.jsxs)(s.li,{children:["A ",(0,i.jsx)(s.strong,{children:"SAML Service Provider"}),", allowing external IdPs (like Okta, Azure AD, or even legacy ADFS systems) to federate users into Keycloak-managed apps."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"That flexibility is one of Keycloak's greatest strengths \u2014 and also where things can get a bit complex."}),"\n",(0,i.jsx)(s.h3,{id:"the-saml-triad-user-sp-idp",children:"The SAML Triad: User, SP, IdP"}),"\n",(0,i.jsx)(s.p,{children:"Let's simplify things. In a typical Keycloak-based SAML setup, you're dealing with three entities:"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.strong,{children:"User"}),": someone trying to log in."]}),"\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.strong,{children:"Service Provider (SP)"}),": your application."]}),"\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.strong,{children:"Identity Provider (IdP)"}),": Keycloak or another IdP."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"When Keycloak is the IdP, it authenticates the user and issues a SAML response back to the SP. When Keycloak is the SP, it receives the SAML response and handles session creation internally."}),"\n",(0,i.jsx)(s.h3,{id:"what-does-a-saml-flow-look-like-in-keycloak",children:"What does a SAML flow look like in Keycloak?"}),"\n",(0,i.jsxs)(s.p,{children:["Let's say Keycloak is acting as the ",(0,i.jsx)(s.strong,{children:"SAML Service Provider"}),". Here's the basic flow:"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"A user tries to access your app."}),"\n",(0,i.jsx)(s.li,{children:"The app redirects the user to Keycloak (the SP)."}),"\n",(0,i.jsx)(s.li,{children:"Keycloak identifies that the user should log in via SAML (based on their realm or identity provider configuration)."}),"\n",(0,i.jsx)(s.li,{children:"Keycloak sends a SAML AuthnRequest to the external IdP (e.g., Okta)."}),"\n",(0,i.jsx)(s.li,{children:"The IdP authenticates the user and sends a signed SAML Response back to Keycloak."}),"\n",(0,i.jsx)(s.li,{children:"Keycloak parses the assertion, validates the signature, and creates a user session."}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"From there, the user gets access to the protected application\u2014without having logged in directly with your app or even with Keycloak."}),"\n",(0,i.jsx)(s.h3,{id:"saml-messages-what-youre-actually-passing-around",children:"SAML messages: what you're actually passing around"}),"\n",(0,i.jsx)(s.p,{children:"In SAML, two XML messages do most of the heavy lifting:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"AuthnRequest"}),' (from SP \u2192 IdP): "Hey, can you authenticate this user for me?"']}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Response"}),' (from IdP \u2192 SP): "Yes, here\'s proof that I authenticated them."']}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"The Response contains one or more Assertions, which are signed blobs of XML confirming that the user is who they say they are. It might look like gibberish to humans, but to systems like Keycloak, it's gold."}),"\n",(0,i.jsx)(s.p,{children:"And yes, validating those signatures is as fussy as it sounds. But Keycloak handles most of that for you \u2014 so long as your trust relationships are properly configured."}),"\n",(0,i.jsx)(s.h4,{id:"the-saml-request",children:"The SAML Request"}),"\n",(0,i.jsx)(s.p,{children:"Before a user is authenticated, Keycloak (acting as the Service Provider) initiates the SAML flow by sending a SAML AuthnRequest to the configured Identity Provider. This request is typically passed via a browser redirect and contains metadata about who's asking for authentication and when."}),"\n",(0,i.jsx)(s.p,{children:"Let's look at an example SAML Request"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-xml",children:'<AuthnRequest xmlns="urn:oasis:names:tc:SAML:2.0:protocol" ID="saml_req_42kpl9zyx0qndmlwv5a6t93ne" Version="2.0" IssueInstant="2025-04-04T15:00:00Z">\n    <Issuer xmlns="urn:oasis:names:tc:SAML:2.0:assertion">\n        https://auth.phasetwo.io/auth/realms/my-tenant/broker/saml-client/endpoint\n    </Issuer>\n</AuthnRequest>\n'})}),"\n",(0,i.jsx)(s.p,{children:"The Issuer tells the IdP who is requesting authentication. The ID is used to match the incoming response back to this request."}),"\n",(0,i.jsx)(s.h4,{id:"the-saml-response",children:"The SAML Response"}),"\n",(0,i.jsx)(s.p,{children:"When your Keycloak instance is acting as a SAML Service Provider, it will receive a SAML Response from the Identity Provider (IdP) after a user successfully authenticates. This response contains critical information like who the user is, how they authenticated, and whether the response is trusted."}),"\n",(0,i.jsx)(s.p,{children:"Let's look at an example SAML Response and break down the pieces:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-xml",children:'<Response IssueInstant="2025-04-04T12:00:00Z" Version="2.0" ID="_abc12345-6789-4def-90ab-abcdef123456" xmlns="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion">\n    <saml:Issuer>https://idp.example.org</saml:Issuer>\n    <ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">\n        <ds:SignedInfo>\n            <ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>\n            <ds:SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha256"/>\n            <ds:Reference URI="#_abc12345-6789-4def-90ab-abcdef123456">\n                <ds:Transforms>\n                    <ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>\n                    <ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#">\n                        <InclusiveNamespaces PrefixList="saml ds xs xsi" xmlns="http://www.w3.org/2001/10/xml-exc-c14n#"/>\n                    </ds:Transform>\n                </ds:Transforms>\n                <ds:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha256"/>\n                <ds:DigestValue>XYZ123abc4567890=</ds:DigestValue>\n            </ds:Reference>\n        </ds:SignedInfo>\n        <ds:SignatureValue>\n            MIIEogIBAAKCAQEA2vGfZPjld7vFq3sGpKUqLbHu0XzX7r8VcU38D1bAgm...\n        </ds:SignatureValue>\n        <ds:KeyInfo>\n            <ds:X509Data>\n                <ds:X509Certificate>\n                    MIIC+zCCAeOgAwIBAgIJAKN+FfK01MywMA0GCSqGSIb3DQEBCwUAMBoxGDAW\n                    BgNVBAMTD2lkcC5leGFtcGxlLm9yZzAeFw0yNTA0MDEwMDAwMDBaFw0yNjA0MDEw\n                    MDAwMDBaMBoxGDAWBgNVBAMTD2lkcC5leGFtcGxlLm9yZzCBnzANBgkqhkiG9w0B\n                    AQEFAAOBjQAwgYkCgYEAzRPl2OslkTfI4E4zVFYoxwHavwJ3uPDbGb8y03wvNVYl\n                    cCy+YBk6yXfiOlNwYQwcz92XJgYBj6+9oA+2bkfy3hDR9QO5Prcb2XtU6cKkB3vC\n                    Z2IUXgsyF7ibOa9hRLo3A7N8Y3RhPG64Q9OcEv0bPPOb/NcAV+UBrQ9rEwUCAwEA\n                    AaNQME4wHQYDVR0OBBYEFH8GhkeIDx4MKZFOZkYI2gfnSkQOMB8GA1UdIwQYMBaA\n                    FH8GhkeIDx4MKZFOZkYI2gfnSkQOMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEL\n                    BQADgYEAFM6CvlquE7ZzpFLiJbR4TG0OCpgG4S2kgNR4+a6+6Zsd+wNoUNdPVFcU\n                    Y4xLf3pJStIjMNxtQPC8j6WxZ9Hk8M+jfqU1mKPgM4zk9C2FJ9GVz9NNVrphTAjO\n                    O6eFcX7zBhf8U4WshjWfHg==\n                </ds:X509Certificate>\n            </ds:X509Data>\n        </ds:KeyInfo>\n    </ds:Signature>\n    <Status>\n        <StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/>\n    </Status>\n    <Assertion ID="_def45678-90ab-4abc-a1b2-cdef56789012" IssueInstant="2025-04-04T12:00:00Z" Version="2.0" xmlns="urn:oasis:names:tc:SAML:2.0:assertion">\n        <Issuer>https://idp.example.org</Issuer>\n        <Subject>\n            <NameID Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress">\n                hello@phasetwo.io\n            </NameID>\n            <SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"/>\n        </Subject>\n        <Conditions NotBefore="2025-04-04T12:00:00Z" NotOnOrAfter="2025-04-04T12:05:00Z">\n            <AudienceRestriction>\n                <Audience>https://sp.myapp.com</Audience>\n            </AudienceRestriction>\n        </Conditions>\n        <AuthnStatement AuthnInstant="2025-04-04T11:59:59Z">\n            <AuthnContext>\n                <AuthnContextClassRef>\n                    urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport\n                </AuthnContextClassRef>\n            </AuthnContext>\n        </AuthnStatement>\n    </Assertion>\n</Response>\n'})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.code,{children:"<Assertion>"})," is where claims about the user are made\u2014like their email or login timestamp."]}),"\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.code,{children:"<Signature>"})," helps ensure this data hasn't been tampered with."]}),"\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.code,{children:"<Audience>"})," defines who this message is meant for\u2014your SP."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Keycloak does the heavy lifting of verifying signatures, extracting claims, and creating a session. But understanding the anatomy of a SAML Response helps when troubleshooting or configuring trust relationships."}),"\n",(0,i.jsx)(s.h3,{id:"trust-is-everything",children:"Trust is everything"}),"\n",(0,i.jsx)(s.p,{children:"For SAML to work securely, the SP and IdP must have a pre-configured trust relationship. That means each side has the other's metadata (usually containing certificates, endpoints, and supported bindings) and knows how to verify signatures."}),"\n",(0,i.jsx)(s.p,{children:"In Keycloak, setting up a SAML identity provider (or service provider) involves uploading or referencing that metadata and tweaking a few settings. Once configured, Keycloak will:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Automatically validate incoming assertions"}),"\n",(0,i.jsx)(s.li,{children:"Map attributes from the assertion into user claims"}),"\n",(0,i.jsx)(s.li,{children:"Create or update user accounts based on SAML attributes"}),"\n",(0,i.jsx)(s.li,{children:"Apply realm-wide policies like required roles or groups"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"butwhy-use-saml-in-2025",children:"But...why use SAML in 2025?"}),"\n",(0,i.jsx)(s.p,{children:"SAML isn't new, sleek, or trendy. But it's everywhere in large enterprises, government systems, and educational institutions. If you want to work with those organizations\u2014or provide identity federation across organizational boundaries\u2014you'll need to speak SAML."}),"\n",(0,i.jsx)(s.p,{children:"Even if your app is all-in on OIDC, SAML bridges can help you bring legacy systems into a modern identity framework. That's where Keycloak really shines: it lets you federate multiple identity providers (SAML, OIDC, LDAP, etc.) into a consistent, centralized user management plane."}),"\n",(0,i.jsx)(s.h3,{id:"why-let-keycloak-handle-saml",children:"Why let keycloak handle SAML?"}),"\n",(0,i.jsxs)(s.p,{children:["Here's the kicker: you don't want to write your own SAML implementation. Parsing, validating, and verifying SAML messages is error-prone and fraught with subtle security pitfalls. With Keycloak (and managed services like ",(0,i.jsx)(s.a,{href:"/hosting",children:"Phase Two"}),"), you don't have to."]}),"\n",(0,i.jsxs)(s.p,{children:["Keycloak abstracts away the complexity. And at Phase Two, we abstract away the operational burden of ",(0,i.jsx)(s.a,{href:"/hosting",children:"hosting"})," and ",(0,i.jsx)(s.a,{href:"/product/identity",children:"securing"})," Keycloak itself. We provide:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Production-grade Keycloak hosting"}),"\n",(0,i.jsx)(s.li,{children:"Built-in SAML and OIDC support"}),"\n",(0,i.jsx)(s.li,{children:"Multi-tenant federation capabilities"}),"\n",(0,i.jsx)(s.li,{children:"Automated updates and backups"}),"\n",(0,i.jsx)(s.li,{children:"Support from experts who live and breathe auth"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"TL;DR"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"SAML is a complex but powerful standard for SSO."}),"\n",(0,i.jsx)(s.li,{children:"Keycloak provides full support for SAML, both as an IdP and SP."}),"\n",(0,i.jsx)(s.li,{children:"Use SAML when you need to integrate with enterprise IdPs or legacy systems."}),"\n",(0,i.jsx)(s.li,{children:"Don't roll your own \u2014 let Keycloak (and Phase Two) handle it."}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Need help configuring SAML in Keycloak? Schedule a consultation today or get in touch at ",(0,i.jsx)(s.a,{href:"mailto:sales@phasetwo.io",children:"sales@phasetwo.io"})]})]})}function c(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},90211:e=>{e.exports=JSON.parse('{"permalink":"/blog/introduction-to-simple-saml","source":"@site/blog/2025-04-10-saml-introduction.md","title":"SAML, Simplified.","description":"SAML has a bit of a reputation. For many developers, it lives in that shadowy corner of the B2B internet where XML still rules and stack traces seem to go on forever. If you\'ve ever had the misfortune of debugging a malformed ``, you know the pain. But here\'s the thing: it doesn\'t have to be a nightmare.","date":"2025-04-10T00:00:00.000Z","tags":[{"inline":true,"label":"phase_two","permalink":"/blog/tags/phase-two"},{"inline":true,"label":"open_source","permalink":"/blog/tags/open-source"},{"inline":true,"label":"saml","permalink":"/blog/tags/saml"},{"inline":true,"label":"authentication","permalink":"/blog/tags/authentication"}],"readingTime":6.735,"hasTruncateMarker":true,"authors":[{"name":"Phase Two","title":"Hosted Keycloak and Keycloak Support","url":"https://github.com/p2-inc","email":"support@phasetwo.io","imageURL":"https://avatars.githubusercontent.com/u/60152109?s=200&v=4","key":"phasetwo","page":null}],"frontMatter":{"title":"SAML, Simplified.","slug":"introduction-to-simple-saml","date":"2025-04-10T00:00:00.000Z","authors":"phasetwo","tags":["phase_two","open_source","saml","authentication"]},"unlisted":false,"prevItem":{"title":"Webauthn and Passkeys with Keycloak","permalink":"/blog/webauthn-keycloak"},"nextItem":{"title":"Keycloak SAML Identity Provider (IdP) Initiated Flow with Okta","permalink":"/blog/keycloak-saml-identity-provider-idp-initiated-flow-with-okta"}}')}}]);