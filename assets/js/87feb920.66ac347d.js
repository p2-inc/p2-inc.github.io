"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[90530],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var s=i(96540);const t={},a=s.createContext(t);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:n},e.children)}},64977:e=>{e.exports=JSON.parse('{"permalink":"/blog/multi-tenancy-options-keycloak","source":"@site/blog/2025-04-21-multi-tenancy-keycloak.md","title":"Understanding Multi-Tenancy Options in Keycloak","description":"As more companies build SaaS platforms, the need to serve multiple customer groups\u2014or tenants\u2014from a single system becomes critical. In the identity world, this means implementing multi-tenancy within your identity provider.","date":"2025-04-21T00:00:00.000Z","tags":[{"inline":true,"label":"phase_two","permalink":"/blog/tags/phase-two"},{"inline":true,"label":"open_source","permalink":"/blog/tags/open-source"},{"inline":true,"label":"multi_tenancy","permalink":"/blog/tags/multi-tenancy"},{"inline":true,"label":"organizations","permalink":"/blog/tags/organizations"},{"inline":true,"label":"keycloak","permalink":"/blog/tags/keycloak"}],"readingTime":4.96,"hasTruncateMarker":true,"authors":[{"name":"Phase Two","title":"Hosted Keycloak and Keycloak Support","url":"https://github.com/p2-inc","email":"support@phasetwo.io","imageURL":"https://avatars.githubusercontent.com/u/60152109?s=200&v=4","key":"phasetwo","page":null}],"frontMatter":{"title":"Understanding Multi-Tenancy Options in Keycloak","slug":"multi-tenancy-options-keycloak","date":"2025-04-21T00:00:00.000Z","authors":"phasetwo","tags":["phase_two","open_source","multi_tenancy","organizations","keycloak"]},"unlisted":false,"prevItem":{"title":"Phase Two Achieves SOC 2 Type 1 Compliance","permalink":"/blog/soc-2-type-1-compliance"},"nextItem":{"title":"Web Application Security with Your Keycloak Deployment","permalink":"/blog/waf-keycloak"}}')},80023:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var s=i(64977),t=i(74848),a=i(28453);const r={title:"Understanding Multi-Tenancy Options in Keycloak",slug:"multi-tenancy-options-keycloak",date:new Date("2025-04-21T00:00:00.000Z"),authors:"phasetwo",tags:["phase_two","open_source","multi_tenancy","organizations","keycloak"]},o="Multi-Tenancy in Keycloak: Why Organizations Are the Future",l={authorsImageUrls:[void 0]},c=[{value:"What Is Multi-Tenancy?",id:"what-is-multi-tenancy",level:2},{value:"Why Multi-Realm Doesn&#39;t Work",id:"why-multi-realm-doesnt-work",level:2},{value:"Problems with Multi-Realm:",id:"problems-with-multi-realm",level:3},{value:"Organizations: A Smarter Approach to Multi-Tenancy",id:"organizations-a-smarter-approach-to-multi-tenancy",level:2},{value:"Theming Per Tenant (Client-Level Customization)",id:"theming-per-tenant-client-level-customization",level:2},{value:"Users in Multiple Organizations",id:"users-in-multiple-organizations",level:2},{value:"Assign Identity Providers to Organizations",id:"assign-identity-providers-to-organizations",level:2},{value:"Get Started with Multi-Tenant Keycloak",id:"get-started-with-multi-tenant-keycloak",level:2}];function h(e){const n={a:"a",br:"br",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["As more companies build SaaS platforms, the need to serve multiple customer groups\u2014or tenants\u2014from a single system becomes critical. In the identity world, this means implementing ",(0,t.jsx)(n.strong,{children:"multi-tenancy"})," within your identity provider."]}),"\n",(0,t.jsx)(n.p,{children:"In this post, we\u2019ll walk through:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"What multi-tenancy means in Keycloak"}),"\n",(0,t.jsx)(n.li,{children:"The drawbacks of using multiple realms for tenants"}),"\n",(0,t.jsx)(n.li,{children:"Why organizations are a better, more scalable approach"}),"\n",(0,t.jsxs)(n.li,{children:["How the Phase Two ",(0,t.jsx)(n.a,{href:"/product/organizations",children:"Organizations"})," extension supports advanced use cases like theming, shared IdPs, and user membership"]}),"\n",(0,t.jsx)(n.li,{children:"How our implementation differs from (and improves on) the new native Keycloak organizations feature"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["We've written extensively about how to ",(0,t.jsx)(n.a,{href:"/blog/multi-tenancy-with-keycloak-organizations",children:"model multi-tenancy with organizations"})," and how Phase Two's ",(0,t.jsx)(n.a,{href:"/blog/phase-two-organizations-shared-idps",children:"Organizations extension differs from the native implementation"})," being undertaken by the Keycloak team."]}),"\n",(0,t.jsxs)(n.p,{children:["All of Phase Two's ",(0,t.jsx)(n.a,{href:"/hosting",children:"hosted"})," environments come standard with all of our ",(0,t.jsx)(n.a,{href:"https://github.com/p2-inc#our-extensions-",children:"popular extensions"})," to make it easy to hit the ground running and cover 95% of all IAM use-cases."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"what-is-multi-tenancy",children:"What Is Multi-Tenancy?"}),"\n",(0,t.jsx)(n.p,{children:"Multi-tenancy is a system architecture where a single instance of software serves multiple logically-separated customers or organizations\u2014each with their own users, permissions, and sometimes custom branding."}),"\n",(0,t.jsx)(n.mermaid,{value:"graph TD\n    subgraph Realm 1\n        K1[Keycloak IAM]\n        A1[Apps #1]\n        A2[Apps #2]\n        A3[Apps #3]\n\n        K1 --\x3e A1\n        K1 --\x3e A2\n        K1 --\x3e A3\n    end"}),"\n",(0,t.jsx)(n.p,{children:"By contrast in a single-tenancy approach, there would need to be a single realm per IAM."}),"\n",(0,t.jsx)(n.mermaid,{value:"graph TD\n    subgraph Realm 1\n        K1[Keycloak IAM #1]\n        A1[Apps #1]\n        K1 --\x3e A1\n    end\n\n    subgraph Realm 2\n        K2[Keycloak IAM #2]\n        A2[Apps #2]\n        K2 --\x3e A2\n    end\n\n    subgraph Realm 3\n        K3[Keycloak IAM #3]\n        A3[Apps #3]\n        K3 --\x3e A3\n    end"}),"\n",(0,t.jsxs)(n.p,{children:["In Keycloak terms, multi-tenancy means allowing multiple organizations to authenticate users, manage roles, and access apps\u2014",(0,t.jsx)(n.strong,{children:"all from a single realm"}),". In a ",(0,t.jsx)(n.strong,{children:"single-tenant"})," architecture, each customer (or tenant) has their own Keycloak realm."]}),"\n",(0,t.jsx)(n.p,{children:"Taking the graph above and changing it to display how Organizations come into play looks as follows. Don't worry if this is confusing at first, we're going to walk through all of it."}),"\n",(0,t.jsx)(n.mermaid,{value:"flowchart LR\n    %% Define standalone nodes\n    U1{{User #1}}\n    U2{{User #2}}\n    U3{{User #3}}\n    K1[App - Keycloak IAM]\n\n    %% Organization and IdP blocks\n    O1[Org #1]\n    O2[Org #2]\n    O3[Org #3]\n\n    I1[/IdP #1\\]\n    I2[/IdP #2\\]\n    I3[/IdP #3\\]\n\n    %% Relationships with labels\n    U1 -- member of --\x3e O1\n    U1 -- member of --\x3e O2\n    U2 -- member of --\x3e O2\n    K1 -- serves --\x3e O1\n    K1 -- serves --\x3e O2\n    K1 -- serves --\x3e O3\n\n    I1 -- federates --\x3e O1\n    O1 -- uses --\x3e I1\n    I2 -- federates --\x3e O2\n    O2 -- uses --\x3e I2\n    I3 -- federates --\x3e O3\n    O3 -- uses --\x3e I3\n\n    %% Subgraph groupings\n    subgraph Realm 1\n        direction TB\n        subgraph Users\n            direction TB\n            U1\n            U2\n            U3\n        end\n\n        subgraph IdPs\n            direction TB\n            I1\n            I2\n            I3\n        end\n\n        subgraph Orgs\n            direction TB\n            O1\n            O2\n            O3\n        end\n    end"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"why-multi-realm-doesnt-work",children:"Why Multi-Realm Doesn't Work"}),"\n",(0,t.jsxs)(n.p,{children:["One of Keycloak\u2019s most common multi-tenant patterns is to create ",(0,t.jsx)(n.strong,{children:"a realm per tenant"}),". This seems clean at first\u2014but has significant downsides:"]}),"\n",(0,t.jsx)(n.h3,{id:"problems-with-multi-realm",children:"Problems with Multi-Realm:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Performance"}),": Keycloak performance degrades when you have hundreds of realms"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Limited Cross-Tenant Features"}),": You can\u2019t easily link users or resources across realms"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Duplication"}),": Users with accounts in multiple realms must manage separate logins and passwords"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Management Overhead"}),": Updating roles, theming, and settings across many realms is tedious and error-prone"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The model simply doesn\u2019t scale when you have 50, 100, or 500 tenants."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"organizations-a-smarter-approach-to-multi-tenancy",children:"Organizations: A Smarter Approach to Multi-Tenancy"}),"\n",(0,t.jsxs)(n.p,{children:["Phase Two's ",(0,t.jsx)(n.a,{href:"/product/organizations",children:(0,t.jsx)(n.strong,{children:"Organizations Extension for Keycloak"})})," enables true multi-tenancy ",(0,t.jsx)(n.strong,{children:"within a single realm"}),"\u2014a more scalable and resource-efficient model."]}),"\n",(0,t.jsx)(n.p,{children:"With Organizations, Keycloak gains first-class multi-tenant capabilities:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Organizations"}),": Define isolated tenant groups"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Memberships"}),": Users can belong to one or more orgs"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Org Roles"}),": Assign roles and permissions within each org"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Invitations"}),": Invite users by email (even before they exist)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Domain association"}),": Automatically map users to orgs by email domain"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Active organization context"}),": Switch between orgs in a single session"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["This lets you maintain secure, segmented access ",(0,t.jsx)(n.strong,{children:"without managing dozens of realms"}),"."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"theming-per-tenant-client-level-customization",children:"Theming Per Tenant (Client-Level Customization)"}),"\n",(0,t.jsxs)(n.p,{children:["Need custom branding for each organization? You can theme Keycloak ",(0,t.jsx)(n.strong,{children:"per client"}),"\u2014and by linking each client to an organization, you effectively get ",(0,t.jsx)(n.strong,{children:"per-tenant theming"}),"."]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a separate client per organization"}),"\n",(0,t.jsx)(n.li,{children:"Assign custom theme to each client (via client settings)"}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"login_theme"})," and ",(0,t.jsx)(n.code,{children:"account_theme"})," in client metadata"]}),"\n",(0,t.jsx)(n.li,{children:"Use the Organization ID or client ID in templates to style login pages dynamically"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This allows each org to have its own login screen\u2014perfect for white-label SaaS."}),"\n",(0,t.jsxs)(n.p,{children:["In order to build out dynamic themes, we highly recommend leveraging ",(0,t.jsx)(n.a,{href:"https://keycloakify.com",children:"Keycloakify"}),", which Phase Two ",(0,t.jsx)(n.a,{href:"/blog/phasetwo-keycloakify-partnership",children:"sponsors"})," and believes heavily in."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"users-in-multiple-organizations",children:"Users in Multiple Organizations"}),"\n",(0,t.jsxs)(n.p,{children:["Unlike the multi-realm model (where each user is siloed), the Organizations extension allows ",(0,t.jsx)(n.strong,{children:"a single user to exist in multiple organizations"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"One email, one username, one login"}),"\n",(0,t.jsx)(n.li,{children:"Organization-specific roles and permissions"}),"\n",(0,t.jsxs)(n.li,{children:["Ability to switch active org via the ",(0,t.jsx)(n.code,{children:"/me"})," ",(0,t.jsx)(n.a,{href:"/api/get-me/",children:"endpoint"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"This is especially powerful for admins, consultants, or vendors who interact with multiple customer orgs."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"assign-identity-providers-to-organizations",children:"Assign Identity Providers to Organizations"}),"\n",(0,t.jsxs)(n.p,{children:["Organizations can now ",(0,t.jsx)(n.strong,{children:"assign the Identity Provider (IdP)"})," to tenants\u2014ideal for social login or enterprise SSO scenarios like Google Workspace:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Define a single OIDC IdP (e.g., Google)"}),"\n",(0,t.jsx)(n.li,{children:"Map it to the orgs"}),"\n",(0,t.jsx)(n.li,{children:"Use email domain matching to assign incoming users to the correct org"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"It\u2019s centralized, scalable, and easier to manage."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"get-started-with-multi-tenant-keycloak",children:"Get Started with Multi-Tenant Keycloak"}),"\n",(0,t.jsx)(n.p,{children:"Multi-tenancy doesn\u2019t have to be hard\u2014or fragile."}),"\n",(0,t.jsx)(n.p,{children:"With Phase Two\u2019s Organizations extension and our managed Keycloak platform, you can:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Support any number of tenants from a single realm"}),"\n",(0,t.jsx)(n.li,{children:"Assign custom branding per org"}),"\n",(0,t.jsx)(n.li,{children:"Link IdPs and manage federated users"}),"\n",(0,t.jsx)(n.li,{children:"Scale securely, with support from the people who built the system"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\ud83d\udc49 ",(0,t.jsx)(n.a,{href:"https://phasetwo.io/product/organizations",children:"Learn more about Organizations \u2192"}),(0,t.jsx)(n.br,{}),"\n","\ud83d\udc49 ",(0,t.jsx)(n.a,{href:"https://dash.phasetwo.io/",children:"Get Started with Free Managed Keycloak \u2192"})]}),"\n",(0,t.jsxs)(n.p,{children:["\ud83d\udce9 ",(0,t.jsx)(n.a,{href:"mailto:sales@phasetwo.io",children:"Reach out to the team \u2192"})]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);