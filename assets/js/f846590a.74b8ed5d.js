"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[7173],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return c}});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=p(n),c=r,k=m["".concat(s,".").concat(c)]||m[c]||u[c]||o;return n?a.createElement(k,i(i({ref:t},d),{},{components:n})):a.createElement(k,i({ref:t},d))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},33632:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return i},default:function(){return u},frontMatter:function(){return o},metadata:function(){return l},toc:function(){return p}});var a=n(83117),r=(n(67294),n(3905));const o={id:"webhooks",title:"Webhooks"},i=void 0,l={unversionedId:"audit-logs/webhooks",id:"audit-logs/webhooks",title:"Webhooks",description:"Webhooks give application developers the ability to listen for all audit events using an HTTP endpoint. Events are sent to your endpoint using the same format as they are submitted in the audit API.",source:"@site/docs/audit-logs/webhooks.md",sourceDirName:"audit-logs",slug:"/audit-logs/webhooks",permalink:"/docs/audit-logs/webhooks",draft:!1,editUrl:"https://github.com/p2-inc/phasetwo-docs/tree/main/docs/audit-logs/webhooks.md",tags:[],version:"current",frontMatter:{id:"webhooks",title:"Webhooks"},sidebar:"docs",previous:{title:"Audit Log API",permalink:"/docs/audit-logs/api"},next:{title:"User Migration",permalink:"/docs/user-migration/"}},s={},p=[{value:"Managing webhook subscriptions",id:"managing-webhook-subscriptions",level:2},{value:"Event types",id:"event-types",level:3},{value:"Enable Webhooks in Admin UI",id:"enable-webhooks-in-admin-ui",level:2},{value:"Retries",id:"retries",level:2},{value:"Client performance",id:"client-performance",level:2},{value:"Example",id:"example",level:2},{value:"Testing",id:"testing",level:2}],d={toc:p};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Webhooks give application developers the ability to listen for all audit events using an HTTP endpoint. Events are sent to your endpoint using the same format as they are submitted in the audit API."),(0,r.kt)("h2",{id:"managing-webhook-subscriptions"},"Managing webhook subscriptions"),(0,r.kt)("p",null,"Webhooks are managed with a custom REST resource with the following methods. Use of these methods requires the authenticated user to have the ",(0,r.kt)("inlineCode",{parentName:"p"},"view-events")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"manage-events")," permissions. If you are using one of the supported languages, we recommend using our ",(0,r.kt)("a",{parentName:"p",href:"/docs/api/sdks"},"SDKs")," rather than building the requests yourself."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Path"),(0,r.kt)("th",{parentName:"tr",align:null},"Method"),(0,r.kt)("th",{parentName:"tr",align:null},"Payload"),(0,r.kt)("th",{parentName:"tr",align:null},"Returns"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/auth/realms/:realm/webhooks")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"GET")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"List of webhook objects"),(0,r.kt)("td",{parentName:"tr",align:null},"Get webhooks")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/auth/realms/:realm/webhooks")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:null},"Webhook object"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"201")),(0,r.kt)("td",{parentName:"tr",align:null},"Create webhook")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/auth/realms/:realm/webhooks/:id")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"GET")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"Webhook object"),(0,r.kt)("td",{parentName:"tr",align:null},"Get webhook")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/auth/realms/:realm/webhooks/:id")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"PUT")),(0,r.kt)("td",{parentName:"tr",align:null},"Webhook object"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"204")),(0,r.kt)("td",{parentName:"tr",align:null},"Update webhook")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/auth/realms/:realm/webhooks/:id")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"DELETE")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"204")),(0,r.kt)("td",{parentName:"tr",align:null},"Delete webhook")))),(0,r.kt)("p",null,"The webhook object has this format:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "475cd2fd-3ca8-4c22-b5c8-c8b8927dcc10",\n  "enabled": "true",\n  "url": "https://example.com/some/webhook",\n  "secret": "ofj09saP4",\n  "eventTypes": ["*"],\n  "createdBy": "ff730b72-a421-4f6e-9e4e-7fc7f53bac88",\n  "createdAt": "2021-04-21T18:25:43-05:00"\n}\n')),(0,r.kt)("p",null,"For creating and updating of webhooks, ",(0,r.kt)("inlineCode",{parentName:"p"},"id"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"createdBy")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"createdAt")," are ignored. ",(0,r.kt)("inlineCode",{parentName:"p"},"secret")," is not sent when fetching webhooks."),(0,r.kt)("h3",{id:"event-types"},"Event types"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"eventTypes")," variable is an array of expressions that match the type of event. It can contain a wildcard, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"*")," (send all events), ",(0,r.kt)("inlineCode",{parentName:"p"},"access.*")," (send all access events), or ",(0,r.kt)("inlineCode",{parentName:"p"},"admin.CLIENT-*")," (send all admin events related to the CLIENT resource type). It can also be a specific event type such as ",(0,r.kt)("inlineCode",{parentName:"p"},"admin-USER-CREATE")," (only send user creation events)."),(0,r.kt)("h2",{id:"enable-webhooks-in-admin-ui"},"Enable Webhooks in Admin UI"),(0,r.kt)("p",null,"Enable webhook events in the Admin UI by going to (Configure) Realm Settings > Events (tab) > Event Listeners, in the Event listeners dropdown select ",(0,r.kt)("inlineCode",{parentName:"p"},"ext-event-webhook")," and Save."),(0,r.kt)("h2",{id:"retries"},"Retries"),(0,r.kt)("p",null,"Webhooks are sent using an automatic exponential backoff if there is not a 2xx response. The sending tasks are scheduled after the transaction which produced the event has been committed, so there is no question if the activity has occured."),(0,r.kt)("h2",{id:"client-performance"},"Client performance"),(0,r.kt)("p",null,"It is expected that the client will ",(0,r.kt)("em",{parentName:"p"},"immediately")," send a 2xx response when receiving an event. If it does not, requests can become backed up and you may miss events because the server will not retry forever."),(0,r.kt)("h2",{id:"example"},"Example"),(0,r.kt)("p",null,"To create a webhook for all events on the ",(0,r.kt)("inlineCode",{parentName:"p"},"test")," realm:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'POST /auth/realms/test/webhooks\n\n{\n  "enabled": "true",\n  "url": "https://exxxxxxxxxxxxxx.m.pipedream.net",\n  "secret": "A3jt6D8lz",\n  "eventTypes": [\n    "*"\n  ]\n}\n')),(0,r.kt)("h2",{id:"testing"},"Testing"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://pipedream.com/"},"Pipedream")," is a great way to test your webhooks, and use the data to integrate with your other applications."))}u.isMDXComponent=!0}}]);