"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[6092],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),l=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),d=l(n),m=a,h=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},11800:function(e,t,n){n.r(t),n.d(t,{assets:function(){return s},contentTitle:function(){return o},default:function(){return p},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return l}});var r=n(83117),a=(n(67294),n(3905));const i={id:"service-accounts",title:"Service Accounts"},o=void 0,c={unversionedId:"api/service-accounts",id:"api/service-accounts",title:"Service Accounts",description:"It is recommended to create one (or more) service accounts in order to call the Phase Two and Keycloak admin APIs. A service account can be thought of as a special type of user that is associated with each Client in Keycloak, but does not have user status in your application.",source:"@site/docs/api/service-accounts.md",sourceDirName:"api",slug:"/api/service-accounts",permalink:"/docs/api/service-accounts",draft:!1,editUrl:"https://github.com/p2-inc/phasetwo-docs/tree/master/docs/api/service-accounts.md",tags:[],version:"current",frontMatter:{id:"service-accounts",title:"Service Accounts"},sidebar:"docs",previous:{title:"API",permalink:"/docs/api/"},next:{title:"Authentication",permalink:"/docs/api/authentication"}},s={},l=[{value:"Creating a client",id:"creating-a-client",level:3},{value:"Mapping roles",id:"mapping-roles",level:3}],u={toc:l};function p(e){let{components:t,...i}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"It is recommended to create one (or more) service accounts in order to call the Phase Two and Keycloak admin APIs. A service account can be thought of as a special type of user that is associated with each Client in Keycloak, but does not have user status in your application."),(0,a.kt)("h3",{id:"creating-a-client"},"Creating a client"),(0,a.kt)("p",null,"Each OIDC client has a built-in service account which allows it to obtain an access token. You can create an configure such a client in the ",(0,a.kt)("strong",{parentName:"p"},"Client")," section by selecting the ",(0,a.kt)("em",{parentName:"p"},"Create client")," button. This will guide you through a wizard to set up your client. The important values to choose are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Client ID")," use a value that indicates to you this is to be used for API access. E.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"api-client")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Client authentication")," must be set to ",(0,a.kt)("strong",{parentName:"li"},"On")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"Service accounts roles")," must be selected.")),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(14674).Z,width:"961",height:"290"}),"\n",(0,a.kt)("img",{src:n(59521).Z,width:"966",height:"370"})),(0,a.kt)("p",null,"Once you have set up the client, find your ",(0,a.kt)("em",{parentName:"p"},"Client secret")," in the ",(0,a.kt)("strong",{parentName:"p"},"Credentials")," tab of the client you just created. Copy and save it for later use."),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(34657).Z,width:"967",height:"532"})),(0,a.kt)("h3",{id:"mapping-roles"},"Mapping roles"),(0,a.kt)("p",null,"There will be a ",(0,a.kt)("strong",{parentName:"p"},"Service accounts roles")," tab in the client. Select this in order to grant roles to the service account user. The ",(0,a.kt)("strong",{parentName:"p"},"Assign role")," button can be used to find roles to grant. The roles you select will likely be found by selecting ",(0,a.kt)("em",{parentName:"p"},"Filter by clients")," and looking for roles in the ",(0,a.kt)("inlineCode",{parentName:"p"},"realm-management")," client."),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(57564).Z,width:"1120",height:"532"})),(0,a.kt)("p",null,"The roles you grant to the service account user, will be dictated by how you intend to use the API. If you will just use it to look up users, you will only need to grant the ",(0,a.kt)("inlineCode",{parentName:"p"},"view-users")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"query-users")," roles. If you are using it to manage organizations you will need to grant the ",(0,a.kt)("inlineCode",{parentName:"p"},"view-organizations"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"manage-organizations"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"view-users")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"query-users")," roles. A full matrix of roles is beyond the scope of this document, but more information can be found in the ",(0,a.kt)("a",{parentName:"p",href:"/api/phase-two-admin-rest-api"},"Phase Two API")," and the ",(0,a.kt)("a",{parentName:"p",href:"https://www.keycloak.org/docs-api/20.0/rest-api/index.html"},"Keycloak Admin REST API")," documentation."))}p.isMDXComponent=!0},14674:function(e,t,n){t.Z=n.p+"assets/images/api-service-accounts-client-1-8e0b76d93d5115db928122d78297ae42.png"},59521:function(e,t,n){t.Z=n.p+"assets/images/api-service-accounts-client-2-238efb126982eb1d19e121189db72b20.png"},34657:function(e,t,n){t.Z=n.p+"assets/images/api-service-accounts-client-secret-da1058004894e33cf36768b6186bd421.png"},57564:function(e,t,n){t.Z=n.p+"assets/images/api-service-accounts-roles-d7c521ffd7614765e678f8661b80c940.png"}}]);