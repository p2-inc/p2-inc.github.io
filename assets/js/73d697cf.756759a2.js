"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[8232],{28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var s=n(96540);const i={},d=s.createContext(i);function r(e){const t=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(d.Provider,{value:t},e.children)}},68148:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>a,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"audit-logs/api","title":"Audit Log API","description":"Customers can use the existing audit logging mechanism to include their own application\'s events. There is a single API method that will consume events in the representation below and make them available for searching, filtering and exporting.","source":"@site/docs/audit-logs/api.md","sourceDirName":"audit-logs","slug":"/audit-logs/api","permalink":"/docs/audit-logs/api","draft":false,"unlisted":false,"editUrl":"https://github.com/p2-inc/phasetwo-docs/tree/main/docs/audit-logs/api.md","tags":[],"version":"current","frontMatter":{"id":"api","title":"Audit Log API"},"sidebar":"docs","previous":{"title":"System","permalink":"/docs/audit-logs/system"},"next":{"title":"Webhooks","permalink":"/docs/audit-logs/webhooks"}}');var i=n(74848),d=n(28453);const r={id:"api",title:"Audit Log API"},l=void 0,o={},c=[{value:"Endpoint",id:"endpoint",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Field definitions",id:"field-definitions",level:2},{value:"Event",id:"event",level:3},{value:"AuthDetails",id:"authdetails",level:3},{value:"Responses",id:"responses",level:2},{value:"Example",id:"example",level:2}];function h(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Customers can use the existing audit logging mechanism to include their own application's events. There is a single API method that will consume events in the representation below and make them available for searching, filtering and exporting."}),"\n",(0,i.jsx)(t.h2,{id:"endpoint",children:"Endpoint"}),"\n",(0,i.jsxs)(t.p,{children:["Events can be posted to the following endpoint. Note that ",(0,i.jsx)(t.code,{children:"host"}),", ",(0,i.jsx)(t.code,{children:"port"})," and ",(0,i.jsx)(t.code,{children:"realm"})," must be replaced with your values. This endpoint accepts and returns JSON content."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"POST https://<host>:<port>/auth/realms/<realm>/events\n"})}),"\n",(0,i.jsx)(t.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(t.p,{children:["Only authenticated users may send events at this time. The current user login access token should be used for browser requests in the ",(0,i.jsx)(t.code,{children:"Authorization"})," HTTP header as below. Backend requests can be made using a service account or other admin access token."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"Authorization: Bearer <accessToken>\n"})}),"\n",(0,i.jsx)(t.h2,{id:"field-definitions",children:"Field definitions"}),"\n",(0,i.jsx)(t.h3,{id:"event",children:"Event"}),"\n",(0,i.jsx)(t.p,{children:"The Event object describes the full action that took place in the system."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"uid"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"An ID unique to this event"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"time"}),(0,i.jsx)(t.td,{children:"number"}),(0,i.jsxs)(t.td,{children:["optional ",(0,i.jsx)(t.sup,{children:(0,i.jsx)(t.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})]}),(0,i.jsx)(t.td,{children:"UNIX timestamp of the event"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"realmId"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"The realm ID where the action took place"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"authDetails"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"#authdetails",children:"AuthDetails"})}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"-"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"type"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"required"}),(0,i.jsx)(t.td,{children:"A description of the action that took place"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"operationType"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"optional"}),(0,i.jsx)(t.td,{children:"What operation was executed on a resource (CREATE, DELETE, UPDATE, ACTION)"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"resourcePath"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"optional"}),(0,i.jsx)(t.td,{children:"If the action changed a resource, this is meant to be the / delimited resource path"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"resourceType"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"optional"}),(0,i.jsx)(t.td,{children:"If the action changed a resource, this is the resource's type"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"details"}),(0,i.jsx)(t.td,{children:"object"}),(0,i.jsx)(t.td,{children:"optional"}),(0,i.jsx)(t.td,{children:"An optional hash of values pertaining to the action that took place"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"error"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"optional"}),(0,i.jsx)(t.td,{children:"An optional error string for tracing purposes if the action resulted in a failure"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"authdetails",children:"AuthDetails"}),"\n",(0,i.jsx)(t.p,{children:"The AuthDetails object provides information on the logged in user executing the action. When posting an event, AuthDetails should be omitted, as it will automatically be provided by the server."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Name"}),(0,i.jsx)(t.th,{children:"Type"}),(0,i.jsx)(t.th,{children:"Required"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"realmId"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"The realm ID of the logged in user"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"clientId"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"The client ID the user was logged into"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"userId"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"The user ID of the logged in user"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"ipAddress"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"The IP address of the logged in user"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"username"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"The username of the logged in user"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"sessionId"}),(0,i.jsx)(t.td,{children:"string"}),(0,i.jsx)(t.td,{children:"provided"}),(0,i.jsx)(t.td,{children:"A unique ID of the current login session"})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"responses",children:"Responses"}),"\n",(0,i.jsx)(t.p,{children:"HTTP status codes are used to indicate types of successful or failure states. A short JSON object will also be returned, with content indicating more informatin about an error state."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Status code"}),(0,i.jsx)(t.th,{children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"202"}),(0,i.jsx)(t.td,{children:"Event received"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"400"}),(0,i.jsx)(t.td,{children:"Malformed event"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"403"}),(0,i.jsx)(t.td,{children:"API rate limit exceeded"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"409"}),(0,i.jsx)(t.td,{children:"Reserved event type"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"5xx"}),(0,i.jsx)(t.td,{children:"Server error"})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'curl https://app.phasetwo.io/auth/realms/company.app/events \\\n  --header "Content-Type: application/json" \\\n  --header "Accept: application/json" \\\n  --header "Authorization: Bearer <accessToken>" \\\n  --data "{ \\"type\\": \\"foo.bar\\" }"\n'})}),"\n","\n",(0,i.jsxs)(t.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(t.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{id:"user-content-fn-1",children:["\n",(0,i.jsxs)(t.p,{children:["If time is not passed by the caller, it will be provided by the server ",(0,i.jsx)(t.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);