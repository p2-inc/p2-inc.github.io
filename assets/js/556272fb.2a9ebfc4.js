"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[23790],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var o=t(96540);const i={},s=o.createContext(i);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:n},e.children)}},87001:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var o=t(90020),i=t(74848),s=t(28453);const r={title:"Web Application Security with Your Keycloak Deployment",slug:"waf-keycloak",date:new Date("2025-04-18T00:00:00.000Z"),authors:"phasetwo",tags:["phase_two","open_source","web_application_security","security"]},a="Do I Need a WAF for My Keycloak Deployment?",l={authorsImageUrls:[void 0]},c=[{value:"What Security Does Keycloak Provide?",id:"what-security-does-keycloak-provide",level:2},{value:"Which Keycloak Endpoints Get Targeted?",id:"which-keycloak-endpoints-get-targeted",level:2},{value:"Commonly targeted endpoints:",id:"commonly-targeted-endpoints",level:3},{value:"So, When Should You Consider a WAF?",id:"so-when-should-you-consider-a-waf",level:2},{value:"You might consider a WAF if:",id:"you-might-consider-a-waf-if",level:3},{value:"Real-World Example: What a DDoS Can Look Like",id:"real-world-example-what-a-ddos-can-look-like",level:2},{value:"How to Architect Defenses Around Keycloak",id:"how-to-architect-defenses-around-keycloak",level:2},{value:"Keycloak Brute Force &amp; Session Policies",id:"keycloak-brute-force--session-policies",level:3},{value:"WAF (Optional but Recommended)",id:"waf-optional-but-recommended",level:3},{value:"Monitoring &amp; Anomaly Detection",id:"monitoring--anomaly-detection",level:3},{value:"Reverse Proxy",id:"reverse-proxy",level:3},{value:"So, Do You Need a WAF?",id:"so-do-you-need-a-waf",level:2},{value:"How Phase Two Helps",id:"how-phase-two-helps",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"As more companies adopt Keycloak for enterprise identity and access management, security is no longer just a back-end concern. One of the most frequent questions we hear at Phase Two is:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:'"Should I put a Web Application Firewall (WAF) in front of Keycloak?"'})}),"\n",(0,i.jsxs)(n.p,{children:["The short answer? ",(0,i.jsx)(n.strong,{children:"It depends"}),"\u2014but it's a smart question to ask."]}),"\n",(0,i.jsx)(n.p,{children:"In this post, we'll break down what Keycloak provides out of the box, explore common attack vectors (especially around authentication endpoints), and help you evaluate whether you need to add an external firewall or WAF to your deployment."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"what-security-does-keycloak-provide",children:"What Security Does Keycloak Provide?"}),"\n",(0,i.jsxs)(n.p,{children:["Keycloak includes several built-in protections, especially around ",(0,i.jsx)(n.strong,{children:"login abuse detection"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Brute Force Detection"}),": Limit login attempts per user/IP combination"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Event Logging"}),": Track login attempts, errors, and success/failure trends"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Account Lockout"}),": Lock users after repeated failures"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rate Limiting"})," (indirect via proxies): Supports integration with reverse proxies/load balancers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Session Expiry Controls"}),": Limits token lifespan and session reuse"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["These help protect against basic abuse patterns like credential stuffing and dictionary attacks\u2014but they aren\u2019t designed to stop ",(0,i.jsx)(n.strong,{children:"network-level threats"})," like DDoS or complex bot traffic."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"which-keycloak-endpoints-get-targeted",children:"Which Keycloak Endpoints Get Targeted?"}),"\n",(0,i.jsxs)(n.p,{children:["The most vulnerable part of a Keycloak deployment is also its most exposed: the ",(0,i.jsx)(n.strong,{children:"login page"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"commonly-targeted-endpoints",children:"Commonly targeted endpoints:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/realms/{realm}/protocol/openid-connect/auth"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/realms/{realm}/protocol/openid-connect/token"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/realms/{realm}/account/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/realms/{realm}/login-actions/authenticate"})}),"\n",(0,i.jsx)(n.li,{children:"Password reset and registration endpoints"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"These routes are exposed by design. If your login page is available to users around the world, it\u2019s available to bots and attackers too."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"so-when-should-you-consider-a-waf",children:"So, When Should You Consider a WAF?"}),"\n",(0,i.jsx)(n.p,{children:"A WAF can protect your Keycloak deployment from a wide range of threats that Keycloak itself is not built to handle, such as:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DDoS attacks"})," targeting login endpoints"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bot-driven enumeration attacks"})," (e.g., slow username probing)"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"IP spoofing or rotation attempts"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Malformed request injection or protocol abuse"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["A WAF provides ",(0,i.jsx)(n.strong,{children:"layer 7 security"}),", filtering traffic based on behavior, headers, and known attack patterns."]}),"\n",(0,i.jsx)(n.h3,{id:"you-might-consider-a-waf-if",children:"You might consider a WAF if:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"You expose Keycloak login pages publicly to thousands/millions of users"}),"\n",(0,i.jsx)(n.li,{children:"You run multi-tenant or CIAM deployments"}),"\n",(0,i.jsx)(n.li,{children:"You\u2019ve experienced repeated attack attempts (or near misses)"}),"\n",(0,i.jsx)(n.li,{children:"You need deeper visibility and mitigation for L7 (application-level) traffic"}),"\n",(0,i.jsx)(n.li,{children:"You want geo-blocking, bot detection, or rate limiting with fine control"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"real-world-example-what-a-ddos-can-look-like",children:"Real-World Example: What a DDoS Can Look Like"}),"\n",(0,i.jsxs)(n.p,{children:["A team running Keycloak recently shared their experience dealing with a ",(0,i.jsx)(n.strong,{children:"multi-phase login enumeration DDoS attack"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Attackers gradually increased pressure, beginning with low-rate enumeration"}),"\n",(0,i.jsx)(n.li,{children:"A misconfiguration allowed for excessive open connections that exhausted resources"}),"\n",(0,i.jsx)(n.li,{children:"Over time, they escalated to thousands of login requests per minute"}),"\n",(0,i.jsx)(n.li,{children:"Sophisticated use of IP rotation made IP bans ineffective"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Even though no data was breached, the attack overwhelmed infrastructure and required layered mitigation\u2014",(0,i.jsx)(n.strong,{children:"including a WAF"})," to filter malicious patterns without affecting legitimate traffic."]}),"\n",(0,i.jsxs)(n.p,{children:["Phase Two has helped customers build resilient defenses to ensure they're ready ",(0,i.jsx)(n.em,{children:"before"})," attackes like this happens."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"how-to-architect-defenses-around-keycloak",children:"How to Architect Defenses Around Keycloak"}),"\n",(0,i.jsx)(n.p,{children:"Whether or not you use a WAF, we recommend the following layered defense strategy. Using some or all of these can help."}),"\n",(0,i.jsx)(n.h3,{id:"keycloak-brute-force--session-policies",children:"Keycloak Brute Force & Session Policies"}),"\n",(0,i.jsx)(n.p,{children:"Enable built-in brute force detection, set aggressive session expiration limits, and disable unused endpoints like user registration."}),"\n",(0,i.jsx)(n.h3,{id:"waf-optional-but-recommended",children:"WAF (Optional but Recommended)"}),"\n",(0,i.jsx)(n.p,{children:"Use a WAF like Cloudflare, AWS WAF, or Fastly to block known bad actors and patterns. Look for features like:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Rate limiting by path (e.g., ",(0,i.jsx)(n.code,{children:"/auth"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Bot management"}),"\n",(0,i.jsx)(n.li,{children:"CAPTCHA or JS challenge enforcement"}),"\n",(0,i.jsx)(n.li,{children:"Real-time threat feeds"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["As part of Phase Two's ",(0,i.jsx)(n.a,{href:"/hosting",children:"Enterprise hosting"})," we provide the ability to integrate the WAF of your choosing along with your infrastructure."]}),"\n",(0,i.jsx)(n.h3,{id:"monitoring--anomaly-detection",children:"Monitoring & Anomaly Detection"}),"\n",(0,i.jsxs)(n.p,{children:["Log traffic and authentication events. Set up alerts for spikes in failures, long-lived sessions, or abnormal IP geographies. Phase Two's built-in ",(0,i.jsx)(n.a,{href:"/hosting",children:"monitoring"})," is already pre-configured to note changes in traffic and abnormal patterns."]}),"\n",(0,i.jsx)(n.h3,{id:"reverse-proxy",children:"Reverse Proxy"}),"\n",(0,i.jsx)(n.p,{children:"Use NGINX or Envoy in front of Keycloak to terminate TLS, cache static assets, and enforce basic rate limits."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"so-do-you-need-a-waf",children:"So, Do You Need a WAF?"}),"\n",(0,i.jsxs)(n.p,{children:["If you're running Keycloak inside a secure corporate network and exposing login only to employees, ",(0,i.jsx)(n.strong,{children:"maybe not"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["But if you're serving external users\u2014especially at scale\u2014the answer leans strongly toward ",(0,i.jsx)(n.strong,{children:"yes"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Even the most robust IAM systems can be overwhelmed by network-level threats they weren\u2019t built to handle. A WAF isn\u2019t a silver bullet\u2014but it\u2019s a strong, smart addition to a well-architected identity stack. Defense-in-depth is truly the only option for full network security of any web property."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"how-phase-two-helps",children:"How Phase Two Helps"}),"\n",(0,i.jsxs)(n.p,{children:["At ",(0,i.jsx)(n.strong,{children:"Phase Two"}),", we specialize in managing and securing Keycloak at scale. Our hosted platform includes:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Hardened Keycloak configurations"}),"\n",(0,i.jsx)(n.li,{children:"Pre-integrated reverse proxy protections"}),"\n",(0,i.jsx)(n.li,{children:"Best-practice DDoS and abuse mitigation"}),"\n",(0,i.jsx)(n.li,{children:"Optional WAF integrations"}),"\n",(0,i.jsx)(n.li,{children:"24/7 observability and response tooling"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"We help teams design IAM infrastructure that\u2019s not just compliant\u2014but resilient."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Want to talk WAFs, login security, or DDoS mitigation?"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\ud83d\udce9 ",(0,i.jsx)(n.a,{href:"mailto:sales@phasetwo.io",children:"Reach out to the team \u2192"})]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udc49 ",(0,i.jsx)(n.a,{href:"https://dash.phasetwo.io/",children:"Get Started with Free Managed Keycloak"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},90020:e=>{e.exports=JSON.parse('{"permalink":"/blog/waf-keycloak","source":"@site/blog/2025-04-18-web-application-security-keycloak.md","title":"Web Application Security with Your Keycloak Deployment","description":"As more companies adopt Keycloak for enterprise identity and access management, security is no longer just a back-end concern. One of the most frequent questions we hear at Phase Two is:","date":"2025-04-18T00:00:00.000Z","tags":[{"inline":true,"label":"phase_two","permalink":"/blog/tags/phase-two"},{"inline":true,"label":"open_source","permalink":"/blog/tags/open-source"},{"inline":true,"label":"web_application_security","permalink":"/blog/tags/web-application-security"},{"inline":true,"label":"security","permalink":"/blog/tags/security"}],"readingTime":4.18,"hasTruncateMarker":true,"authors":[{"name":"Phase Two","title":"Hosted Keycloak and Keycloak Support","url":"https://github.com/p2-inc","email":"support@phasetwo.io","imageURL":"https://avatars.githubusercontent.com/u/60152109?s=200&v=4","key":"phasetwo","page":null}],"frontMatter":{"title":"Web Application Security with Your Keycloak Deployment","slug":"waf-keycloak","date":"2025-04-18T00:00:00.000Z","authors":"phasetwo","tags":["phase_two","open_source","web_application_security","security"]},"unlisted":false,"prevItem":{"title":"Understanding Multi-Tenancy Options in Keycloak","permalink":"/blog/multi-tenancy-options-keycloak"},"nextItem":{"title":"Webauthn and Passkeys with Keycloak","permalink":"/blog/webauthn-keycloak"}}')}}]);