"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[6853],{28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var s=n(96540);const i={},c=s.createContext(i);function o(e){const t=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(c.Provider,{value:t},e.children)}},29409:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/api-service-accounts-client-2-238efb126982eb1d19e121189db72b20.png"},43343:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/api-service-accounts-client-secret-da1058004894e33cf36768b6186bd421.png"},54638:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/api-service-accounts-roles-d7c521ffd7614765e678f8661b80c940.png"},73192:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"api/service-accounts","title":"Service Accounts","description":"It is recommended to create one (or more) service accounts in order to call the Phase Two and Keycloak admin APIs. A service account can be thought of as a special type of user that is associated with each Client in Keycloak, but does not have user status in your application.","source":"@site/docs/api/service-accounts.md","sourceDirName":"api","slug":"/api/service-accounts","permalink":"/docs/api/service-accounts","draft":false,"unlisted":false,"editUrl":"https://github.com/p2-inc/phasetwo-docs/tree/main/docs/api/service-accounts.md","tags":[],"version":"current","frontMatter":{"id":"service-accounts","title":"Service Accounts"},"sidebar":"docs","previous":{"title":"API","permalink":"/docs/api/"},"next":{"title":"Authentication","permalink":"/docs/api/authentication"}}');var i=n(74848),c=n(28453);const o={id:"service-accounts",title:"Service Accounts"},a=void 0,r={},l=[{value:"Creating a client",id:"creating-a-client",level:3},{value:"Mapping roles",id:"mapping-roles",level:3}];function d(e){const t={a:"a",code:"code",em:"em",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"It is recommended to create one (or more) service accounts in order to call the Phase Two and Keycloak admin APIs. A service account can be thought of as a special type of user that is associated with each Client in Keycloak, but does not have user status in your application."}),"\n",(0,i.jsx)(t.h3,{id:"creating-a-client",children:"Creating a client"}),"\n",(0,i.jsxs)(t.p,{children:["Each OIDC client has a built-in service account which allows it to obtain an access token. You can create an configure such a client in the ",(0,i.jsx)(t.strong,{children:"Client"})," section by selecting the ",(0,i.jsx)(t.em,{children:"Create client"})," button. This will guide you through a wizard to set up your client. The important values to choose are:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"Client ID"})," use a value that indicates to you this is to be used for API access. E.g. ",(0,i.jsx)(t.code,{children:"api-client"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"Client authentication"})," must be set to ",(0,i.jsx)(t.strong,{children:"On"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"Service accounts roles"})," must be selected."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.img,{alt:"Keycloak Create Service Account Settings",src:n(80426).A+"",width:"961",height:"290"}),"\n",(0,i.jsx)(t.img,{alt:"Keycloak Create Service Account Config",src:n(29409).A+"",width:"966",height:"370"})]}),"\n",(0,i.jsxs)(t.p,{children:["Once you have set up the client, find your ",(0,i.jsx)(t.em,{children:"Client secret"})," in the ",(0,i.jsx)(t.strong,{children:"Credentials"})," tab of the client you just created. Copy and save it for later use."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Keycloak Create Service Account Client Secret",src:n(43343).A+"",width:"967",height:"532"})}),"\n",(0,i.jsx)(t.h3,{id:"mapping-roles",children:"Mapping roles"}),"\n",(0,i.jsxs)(t.p,{children:["There will be a ",(0,i.jsx)(t.strong,{children:"Service accounts roles"})," tab in the client. Select this in order to grant roles to the service account user. The ",(0,i.jsx)(t.strong,{children:"Assign role"})," button can be used to find roles to grant. The roles you select will likely be found by selecting ",(0,i.jsx)(t.em,{children:"Filter by clients"})," and looking for roles in the ",(0,i.jsx)(t.code,{children:"realm-management"})," client."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Keycloak Create Service Account Client Roles",src:n(54638).A+"",width:"1120",height:"532"})}),"\n",(0,i.jsxs)(t.p,{children:["The roles you grant to the service account user, will be dictated by how you intend to use the API. If you will just use it to look up users, you will only need to grant the ",(0,i.jsx)(t.code,{children:"view-users"})," and ",(0,i.jsx)(t.code,{children:"query-users"})," roles. If you are using it to manage organizations you will need to grant the ",(0,i.jsx)(t.code,{children:"view-organizations"}),", ",(0,i.jsx)(t.code,{children:"manage-organizations"}),", ",(0,i.jsx)(t.code,{children:"view-users"})," and ",(0,i.jsx)(t.code,{children:"query-users"})," roles. A full matrix of roles is beyond the scope of this document, but more information can be found in the ",(0,i.jsx)(t.a,{href:"/api/phase-two-admin-rest-api",children:"Phase Two API"})," and the ",(0,i.jsx)(t.a,{href:"https://www.keycloak.org/docs-api/latest/rest-api/index.html",children:"Keycloak Admin REST API"})," documentation."]})]})}function u(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},80426:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/api-service-accounts-client-1-8e0b76d93d5115db928122d78297ae42.png"}}]);