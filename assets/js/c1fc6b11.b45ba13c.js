"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[37416],{28453:(e,i,t)=>{t.d(i,{R:()=>s,x:()=>r});var n=t(96540);const a={},o=n.createContext(a);function s(e){const i=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(o.Provider,{value:i},e.children)}},53290:(e,i,t)=>{t.d(i,{A:()=>n});const n=t.p+"assets/images/organizations-invitations-invite-ff7880e50b1b2568ee4758b2a6ffe7c0.png"},66919:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"organizations/invitations","title":"Invitations","description":"Invitations provide a way to allow Keycloak and organization administrators to invite new members to the organization.","source":"@site/docs/organizations/invitations.md","sourceDirName":"organizations","slug":"/organizations/invitations","permalink":"/docs/organizations/invitations","draft":false,"unlisted":false,"editUrl":"https://github.com/p2-inc/phasetwo-docs/tree/main/docs/organizations/invitations.md","tags":[],"version":"current","frontMatter":{"id":"invitations","title":"Invitations"},"sidebar":"docs","previous":{"title":"Membership","permalink":"/docs/organizations/membership"},"next":{"title":"Roles","permalink":"/docs/organizations/roles"}}');var a=t(74848),o=t(28453);const s={id:"invitations",title:"Invitations"},r=void 0,l={},c=[{value:"Setup",id:"setup",level:3},{value:"Admin Portal",id:"admin-portal",level:4},{value:"Options for user registration",id:"options-for-user-registration",level:3},{value:"Self-registration",id:"self-registration",level:4},{value:"Magic-Link",id:"magic-link",level:4},{value:"API access",id:"api-access",level:3}];function d(e){const i={a:"a",code:"code",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.p,{children:"Invitations provide a way to allow Keycloak and organization administrators to invite new members to the organization."}),"\n",(0,a.jsx)(i.p,{children:"Invitations can be managed by the Keycloak admin in the Organizations tab of the Admin UI. You can enable organization administrators to manage invitations using the organization portal or building it into your application using the API. Creating an invite does not mean that the user is created, only that an invitation is pending for the given email address. The user will need to register with your application and will be presented a required action to accept the invitation."}),"\n",(0,a.jsx)(i.p,{children:(0,a.jsx)(i.img,{alt:"Keycloak Phase Two Organizations Invites",src:t(53290).A+"",width:"795",height:"450"})}),"\n",(0,a.jsx)(i.h3,{id:"setup",children:"Setup"}),"\n",(0,a.jsxs)(i.p,{children:["Invitees may or may not be existing users. If you choose to allow invitations to emails that are not represented by existing users, you must allow registration to your application, or use an authentication flow that automatically creates user accounts (such as ",(0,a.jsx)(i.a,{href:"/docs/authentication/magic-links",children:"magic link"})," authentication)."]}),"\n",(0,a.jsxs)(i.p,{children:["If you want to email users an invite, it is important to provide a ",(0,a.jsx)(i.code,{children:"redirectUri"})," to your application. Unless you have customized the [email template] at present to hard code an invite url, no link will be present in the email for the user to click on."]}),"\n",(0,a.jsxs)(i.p,{children:["It is possible to pre-select any roles for a user by passing the ",(0,a.jsx)(i.code,{children:"roles"})," array in the API (pre-selecting in the Admin UI is currently not implemented). This will automatically add the user to the given roles upon user creation and acceptance of the invitation."]}),"\n",(0,a.jsxs)(i.p,{children:["Adapt the ",(0,a.jsx)(i.a,{href:"https://github.com/p2-inc/keycloak-orgs?tab=readme-ov-file#authentication",children:"Authentication"})," according to your needs."]}),"\n",(0,a.jsx)(i.p,{children:"Note: Users must have a verified email address to accept an invitation, as it presents a security issue to allow any User to register with an unverified email address and claim the invitation."}),"\n",(0,a.jsx)(i.p,{children:"Following user creation and authentication, invitees will be prompted to accept or decline any outstanding invitations. In addition to any roles that were selected in the invitation, the user will automatically be added as a member to the inviting organization."}),"\n",(0,a.jsx)(i.h4,{id:"admin-portal",children:"Admin Portal"}),"\n",(0,a.jsxs)(i.p,{children:["If you plan to use the Admin Portal to manage invitations, then you must configure the invitation template because there is no ",(0,a.jsx)(i.code,{children:"redirectUri"})," field provided like in the Keycloak admin UI. In order to configure this template easily in the Phase Two deployments, enable the ",(0,a.jsx)(i.code,{children:"attributes"})," theme for emails in the Realm Settings > Themes > Email Theme."]}),"\n",(0,a.jsxs)(i.p,{children:["Once the attributes theme is set, go to (Extensions) Styles > ",(0,a.jsx)(i.a,{href:"https://phasetwo.io/docs/getting-started/email/#content-templates",children:"Emails"}),", select the ",(0,a.jsx)(i.code,{children:"invitation-email"})," template and configure the ",(0,a.jsx)(i.code,{children:"{{link}}"})," you would like to have in your email for the user to click on."]}),"\n",(0,a.jsx)(i.h3,{id:"options-for-user-registration",children:"Options for user registration"}),"\n",(0,a.jsx)(i.h4,{id:"self-registration",children:"Self-registration"}),"\n",(0,a.jsx)(i.p,{children:"This option requires either creating users on behalf of them before sending the invitation or enabling user registration on the realm."}),"\n",(0,a.jsx)(i.p,{children:"Invitees will receive an email indicating the realm, organization and inviter. It is possible to add a specific application redirect URI so that they will be redirected to a specific location in the application."}),"\n",(0,a.jsx)(i.h4,{id:"magic-link",children:"Magic-Link"}),"\n",(0,a.jsxs)(i.p,{children:["This approach uses another extension in order to provide a ",(0,a.jsx)(i.a,{href:"https://github.com/p2-inc/keycloak-magic-link",children:"magic link"})," that will first register the user, authenticate them, and then present them with the required action to accept the invitation. This approach is preferred when user registration is disabled. It requires the following steps:"]}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsxs)(i.li,{children:[(0,a.jsx)(i.a,{href:"https://phasetwo.io/api/create-magic-link",children:"Create a magic link"})," using ",(0,a.jsx)(i.code,{children:"force_create=true"})," (to create a user if one does not exist) and ",(0,a.jsx)(i.code,{children:"send_email=false"})," to skip sending the magic link to the user."]}),"\n",(0,a.jsxs)(i.li,{children:["Use the returned magic link when ",(0,a.jsx)(i.a,{href:"https://phasetwo.io/api/add-organization-invitation",children:"creating an invitation"}),". Set the ",(0,a.jsx)(i.code,{children:"redirectUri={magic-link}"}),"."]}),"\n"]}),"\n",(0,a.jsx)(i.h3,{id:"api-access",children:"API access"}),"\n",(0,a.jsxs)(i.p,{children:["It is possible to ",(0,a.jsx)(i.a,{href:"/api/add-organization-invitation",children:"create"}),", ",(0,a.jsx)(i.a,{href:"/api/remove-organization-invitation",children:"remove pending"})," and ",(0,a.jsx)(i.a,{href:"/api/get-organization-invitations",children:"fetch all outstanding"})," organization invitations using the API."]})]})}function h(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}}}]);