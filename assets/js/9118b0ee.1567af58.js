"use strict";(self.webpackChunkphasetwo_docs=self.webpackChunkphasetwo_docs||[]).push([[919],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=c(a),m=i,d=h["".concat(l,".").concat(m)]||h[m]||p[m]||o;return a?n.createElement(d,r(r({ref:t},u),{},{components:a})):n.createElement(d,r({ref:t},u))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var c=2;c<o;c++)r[c]=a[c];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},45893:function(e,t,a){a.r(t),a.d(t,{assets:function(){return l},contentTitle:function(){return r},default:function(){return p},frontMatter:function(){return o},metadata:function(){return s},toc:function(){return c}});var n=a(83117),i=(a(67294),a(3905));const o={slug:"set-up-magic-links",title:"Magic Links Guide, and 5 Minute Setup for Open Source Passwordless Authentication and Better Security",authors:"phasetwo",tags:["tutorial","keycloak","phase_two","magic_links"]},r=void 0,s={permalink:"/blog/set-up-magic-links",source:"@site/blog/2022-10-12-set-up-magic-links.md",title:"Magic Links Guide, and 5 Minute Setup for Open Source Passwordless Authentication and Better Security",description:'Someone who is reading this article is probably very different that the average internet user when it comes to passwords. Developers and IT admins, either because of security savvy or compliance, use password managers, multi-factor authentication (MFA) mechanisms, or prefer sites that offer passwordless authentication. Furthermore, they are keenly aware of the weaknesses in their personal "attack surface", and search for ways to balance convenience with risk.',date:"2022-10-12T00:00:00.000Z",formattedDate:"October 12, 2022",tags:[{label:"tutorial",permalink:"/blog/tags/tutorial"},{label:"keycloak",permalink:"/blog/tags/keycloak"},{label:"phase_two",permalink:"/blog/tags/phase-two"},{label:"magic_links",permalink:"/blog/tags/magic-links"}],readingTime:5.545,hasTruncateMarker:!0,authors:[{name:"Phase Two",title:"Hosted Keycloak and Keycloak Support",url:"https://github.com/p2-inc",email:"support@phasetwo.io",imageURL:"https://avatars.githubusercontent.com/u/60152109?s=200&v=4",key:"phasetwo"}],frontMatter:{slug:"set-up-magic-links",title:"Magic Links Guide, and 5 Minute Setup for Open Source Passwordless Authentication and Better Security",authors:"phasetwo",tags:["tutorial","keycloak","phase_two","magic_links"]},prevItem:{title:"Protecting Your Application With Keycloak",permalink:"/blog/securing-apps-with-keycloak"},nextItem:{title:"Set Up Email in Phase Two for a Better Branding Experience",permalink:"/blog/set-up-email"}},l={authorsImageUrls:[void 0]},c=[{value:"What are magic links?",id:"what-are-magic-links",level:3},{value:"Pros and cons",id:"pros-and-cons",level:3},{value:"Limiting risk",id:"limiting-risk",level:3},{value:"Setup guide",id:"setup-guide",level:3}],u={toc:c};function p(e){let{components:t,...o}=e;return(0,i.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,'Someone who is reading this article is probably very different that the average internet user when it comes to passwords. Developers and IT admins, either because of security savvy or compliance, use password managers, multi-factor authentication (MFA) mechanisms, or prefer sites that offer passwordless authentication. Furthermore, they are keenly aware of the weaknesses in their personal "attack surface", and search for ways to balance convenience with risk.'),(0,i.kt)("p",null,"But you are here because you want to find a way to implement magic links quickly. First, some background."),(0,i.kt)("p",null,"The extension is available on ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/p2-inc/keycloak-magic-link"},"Github"),"."),(0,i.kt)("h3",{id:"what-are-magic-links"},"What are magic links?"),(0,i.kt)("p",null,"Magic links are a type of passwordless authentication that allow your users to log in to your application following a link that is emailed to them, rather than typing a username and password. Magic links can also be used as a part of a multi-factor authentication (MFA) strategy."),(0,i.kt)("p",null,"In a magic link flow, the application's authentication provider asks users for an email address rather than a password. The authentication provider generates a link with an embedded token, and sends to the user's email. There may be some other steps taken by the provider, such as verifying the provided email address matches an existing user. The user then opens the email, clicks the link, is verified by the authentication provider, and is granted access to the application"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Keycloak Phase Two Magic Link Extension Flow Diagram",src:a(22006).Z,width:"768",height:"466"})),(0,i.kt)("h3",{id:"pros-and-cons"},"Pros and cons"),(0,i.kt)("p",null,"Like any mechanism that tries to streamline a security process such as authentication, there are both pros and cons to the magic link approach. First in the plus column:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Enhances user experience, which makes users more likely to use your application, and be satisfied with the experience. This drives user engagement."),(0,i.kt)("li",{parentName:"ul"},"User onboarding is accelerated, as magic links can be sent to new users as well as existing ones. Registration for your application is as easy as entering your email address."),(0,i.kt)("li",{parentName:"ul"},"You'll never have a password breach. When there are no passwords, there are no password breaches. A huge number of corporate data breaches are due to insufficient and compromised passwords."),(0,i.kt)("li",{parentName:"ul"},"No more customer support requests related to lost passwords. Over half of customer support requests are due to authentication problems, many of those are users unable to remember their passwords. This eliminates a huge portion of those.")),(0,i.kt)("p",null,"Nothing is perfect, and there are also several potential downsides to magic links:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Account security and access are now tied to the security of the user's email account. If the user's computer or other device is compromised, and attacker could potentially obtain the link and impersonate the user."),(0,i.kt)("li",{parentName:"ul"},"If the user or email provider does not enforce encrypted network access to email, it may be possible for an attacker to perform a man-in-the-middle attack where they can obtain the link by observing network traffic."),(0,i.kt)("li",{parentName:"ul"},"Ability to access your application is now tied to email deliverability. If your email service or the user's email provider fails to deliver the email containing the link in a timely fashion, it could deteriorate the experience for the user.")),(0,i.kt)("h3",{id:"limiting-risk"},"Limiting risk"),(0,i.kt)("p",null,"Fortunately, there are things your application and the user can do in order to limit some of the possible downside risks of using magic links. Your application can:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Make the magic links single use, or set a very short expiration time for the links."),(0,i.kt)("li",{parentName:"ul"},"Enforce an additional factor when using magic links.")),(0,i.kt)("p",null,"Your user can:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Choose an email provider that enforces the use of encrypted connections."),(0,i.kt)("li",{parentName:"ul"},"Use multi-factor authentication (MFA) mechanisms to further protect their email accounts.")),(0,i.kt)("h3",{id:"setup-guide"},"Setup guide"),(0,i.kt)("p",null,"Sorry for the wait! We wanted to give you an overview of magic links before diving into how to set them up with Phase Two."),(0,i.kt)("p",null,"If you haven't already, get an account on ",(0,i.kt)("a",{parentName:"p",href:"https://phasetwo.io/dashboard"},"Phase Two"),". You'll notice that we use magic links in addition to social login options. As we said above, we're trying to make it as frictionless as possible to get in and start using the product."),(0,i.kt)("p",null,"Once you log in and create your first deployment, open the Phase Two enhanced Keycloak console. In order to email links to your users, you'll need to set up email. If you haven't already done that, head over to our ",(0,i.kt)("a",{parentName:"p",href:"/blog/set-up-email"},"email setup guide"),"."),(0,i.kt)("p",null,"After you've completed email setup, select the ",(0,i.kt)("strong",{parentName:"p"},"Authentication")," menu item, and then select the ",(0,i.kt)("strong",{parentName:"p"},"Magic link")," flow from the list."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Keycloak Phase Two Magic Link Authentication Page Flow Name",src:a(8329).Z,width:"1427",height:"816"})),(0,i.kt)("p",null,"Open the configuration for the ",(0,i.kt)("strong",{parentName:"p"},"Magic Link Authenticator")," by clicking the gear icon on the last line with the ",(0,i.kt)("strong",{parentName:"p"},"Magic Link")," execution. You'll notice two options:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Force create user")," creates a new user when an email is provided that does not match an existing user. This allows the use of magic links to register new users that have not been previously seen."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Update profile on create")," adds an UPDATE_PROFILE required action if the user was created. This means that the user will need to fill out other required fields such as first/last name, etc.")),(0,i.kt)("p",null,"For the purpose of our demonstration, let's set ",(0,i.kt)("strong",{parentName:"p"},"Force create user")," to ON and ",(0,i.kt)("strong",{parentName:"p"},"Update profile on create")," to OFF (remember, low friction). Save the configuration, and go back to the flow page."),(0,i.kt)("p",null,"In the ",(0,i.kt)("strong",{parentName:"p"},"Action")," menu of the flow page, select ",(0,i.kt)("strong",{parentName:"p"},"Bind"),", and select ",(0,i.kt)("strong",{parentName:"p"},"Browser flow"),"."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Keycloak Phase Two Magic Link Bind Flow",src:a(52632).Z,width:"1136",height:"198"})),(0,i.kt)("p",null,"Now you're ready to test it out. If you don't have an application that is setup and protected by Keycloak, you can use the built-in account console to try it out. Navigate to the ",(0,i.kt)("strong",{parentName:"p"},"Clients")," menu, and open the link next to the ",(0,i.kt)("strong",{parentName:"p"},"account")," client in an incognito window (this will prevent conflict, as you are already logged in to the admin console as the administrator)."),(0,i.kt)("p",null,"Click ",(0,i.kt)("strong",{parentName:"p"},"Sign In")," and you'll be redirected to the authentication page. Enter your email address, and you'll be sent a magic link. Click on the link in your email, and you'll see your details in the account console."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Keycloak Phase Two Magic Link Login Page",src:a(43676).Z,width:"530",height:"376"}),"\n",(0,i.kt)("img",{alt:"Keycloak Phase Two Magic Link Confirm Page",src:a(31370).Z,width:"538",height:"256"})),(0,i.kt)("p",null,"Go back to the admin console in the other browser window, and navigate to the ",(0,i.kt)("strong",{parentName:"p"},"Users")," section. You will be able to find the user that was just created."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Keycloak Phase Two Magic Link Admin User View",src:a(32140).Z,width:"1145",height:"368"})),(0,i.kt)("p",null,"Magic links are a great way to streamline your user onboarding and experience to help you easily drive engagement across your application. Phase Two makes it quick and easy to integrate magic links (and social login, and enterprise SSO, and much more). Stay tuned for more guides that will help you build the authentication experience that is right for your app."))}p.isMDXComponent=!0},32140:function(e,t,a){t.Z=a.p+"assets/images/2022-10-12-set-up-magic-links-admin-user-4355a7cb65d28f64cdd1ba146855c63b.png"},52632:function(e,t,a){t.Z=a.p+"assets/images/2022-10-12-set-up-magic-links-bind-160640f1880ba16e2771180440b26c73.png"},31370:function(e,t,a){t.Z=a.p+"assets/images/2022-10-12-set-up-magic-links-confirm-75f643520e911befbbe787e370def0f2.png"},22006:function(e,t,a){t.Z=a.p+"assets/images/2022-10-12-set-up-magic-links-flow-b4ec250b3b1faa0bcfe403ca9ca0a7d8.png"},43676:function(e,t,a){t.Z=a.p+"assets/images/2022-10-12-set-up-magic-links-login-8e1477c5b0ce012da2fcd791e3dad4f7.png"},8329:function(e,t,a){t.Z=a.p+"assets/images/2022-10-12-set-up-magic-links-magiclinkauth-e40ff40256c02d0f4280f41e7594016c.png"}}]);